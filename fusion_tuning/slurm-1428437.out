/usr/share/lmod/lmod/init/sh: line 20: /usr/share/lmod/lmod/libexec//clearMT_cmd: No such file or directory
Running job on GPU : Tesla V100-PCIE-32GB
Namespace(BATCH_SIZE=128, CHECKPOINTS_PATH='/scratch/izar/santacro/checkpoints/', DATASET_PATH='/scratch/izar/santacro/final_data/', DEVICE='cuda:0', EMBEDDING='longformer', EPOCH_NUM=300, FRACTION=40, FUSION='sum', HIDDEN_SIZE=8192, LEARNING_RATE=1e-05, LEVEL='L1', LOAD_CHECKPOINT='no', MERGE_METHOD='fusion', MIN_LEARNING_RATE=1e-06, NORMALIZE='no', NUM_WORKERS=8, RANDOM_STATE=1, RUN_MODE='train', SAVE_CHECKPOINTS='yes', SPLITTING='species', TARGET_BASE='set', WANDB_ENTITY='msc-nicola', WANDB_LOGS='no', WANDB_PROJECT='fusion_tuning')
  0%|          | 0/300 [00:00<?, ?it/s]train/val metrics at epoch 1 | loss : 1.16/1.06 | micro_F1 : 0.23/0.21:   0%|          | 0/300 [00:11<?, ?it/s]train/val metrics at epoch 1 | loss : 1.16/1.06 | micro_F1 : 0.23/0.21:   0%|          | 1/300 [00:12<1:02:19, 12.51s/it]train/val metrics at epoch 2 | loss : 1.14/1.05 | micro_F1 : 0.25/0.19:   0%|          | 1/300 [00:18<1:02:19, 12.51s/it]train/val metrics at epoch 2 | loss : 1.14/1.05 | micro_F1 : 0.25/0.19:   1%|          | 2/300 [00:19<44:34,  8.97s/it]  train/val metrics at epoch 3 | loss : 1.13/1.04 | micro_F1 : 0.26/0.21:   1%|          | 2/300 [00:24<44:34,  8.97s/it]train/val metrics at epoch 3 | loss : 1.13/1.04 | micro_F1 : 0.26/0.21:   1%|          | 3/300 [00:25<38:05,  7.70s/it]train/val metrics at epoch 4 | loss : 1.11/1.04 | micro_F1 : 0.28/0.24:   1%|          | 3/300 [00:31<38:05,  7.70s/it]train/val metrics at epoch 4 | loss : 1.11/1.04 | micro_F1 : 0.28/0.24:   1%|▏         | 4/300 [00:31<35:01,  7.10s/it]train/val metrics at epoch 5 | loss : 1.10/1.03 | micro_F1 : 0.29/0.27:   1%|▏         | 4/300 [00:37<35:01,  7.10s/it]train/val metrics at epoch 5 | loss : 1.10/1.03 | micro_F1 : 0.29/0.27:   2%|▏         | 5/300 [00:37<33:25,  6.80s/it]train/val metrics at epoch 6 | loss : 1.09/1.06 | micro_F1 : 0.31/0.24:   2%|▏         | 5/300 [00:43<33:25,  6.80s/it]train/val metrics at epoch 6 | loss : 1.09/1.06 | micro_F1 : 0.31/0.24:   2%|▏         | 6/300 [00:43<32:27,  6.62s/it]train/val metrics at epoch 7 | loss : 1.09/1.03 | micro_F1 : 0.30/0.27:   2%|▏         | 6/300 [00:49<32:27,  6.62s/it]train/val metrics at epoch 7 | loss : 1.09/1.03 | micro_F1 : 0.30/0.27:   2%|▏         | 7/300 [00:50<31:45,  6.50s/it]train/val metrics at epoch 8 | loss : 1.08/1.03 | micro_F1 : 0.31/0.28:   2%|▏         | 7/300 [00:56<31:45,  6.50s/it]train/val metrics at epoch 8 | loss : 1.08/1.03 | micro_F1 : 0.31/0.28:   3%|▎         | 8/300 [00:56<31:25,  6.46s/it]train/val metrics at epoch 9 | loss : 1.07/1.01 | micro_F1 : 0.32/0.23:   3%|▎         | 8/300 [01:02<31:25,  6.46s/it]train/val metrics at epoch 9 | loss : 1.07/1.01 | micro_F1 : 0.32/0.23:   3%|▎         | 9/300 [01:02<30:57,  6.38s/it]train/val metrics at epoch 10 | loss : 1.06/1.02 | micro_F1 : 0.32/0.24:   3%|▎         | 9/300 [01:09<30:57,  6.38s/it]train/val metrics at epoch 10 | loss : 1.06/1.02 | micro_F1 : 0.32/0.24:   3%|▎         | 10/300 [01:09<31:00,  6.42s/it]train/val metrics at epoch 11 | loss : 1.06/1.00 | micro_F1 : 0.32/0.32:   3%|▎         | 10/300 [01:15<31:00,  6.42s/it]train/val metrics at epoch 11 | loss : 1.06/1.00 | micro_F1 : 0.32/0.32:   4%|▎         | 11/300 [01:15<30:25,  6.32s/it]train/val metrics at epoch 12 | loss : 1.06/1.00 | micro_F1 : 0.33/0.32:   4%|▎         | 11/300 [01:21<30:25,  6.32s/it]train/val metrics at epoch 12 | loss : 1.06/1.00 | micro_F1 : 0.33/0.32:   4%|▍         | 12/300 [01:21<30:02,  6.26s/it]train/val metrics at epoch 13 | loss : 1.05/1.02 | micro_F1 : 0.33/0.20:   4%|▍         | 12/300 [01:27<30:02,  6.26s/it]train/val metrics at epoch 13 | loss : 1.05/1.02 | micro_F1 : 0.33/0.20:   4%|▍         | 13/300 [01:27<29:54,  6.25s/it]train/val metrics at epoch 14 | loss : 1.05/1.00 | micro_F1 : 0.33/0.29:   4%|▍         | 13/300 [01:33<29:54,  6.25s/it]train/val metrics at epoch 14 | loss : 1.05/1.00 | micro_F1 : 0.33/0.29:   5%|▍         | 14/300 [01:33<29:44,  6.24s/it]train/val metrics at epoch 15 | loss : 1.04/1.01 | micro_F1 : 0.34/0.37:   5%|▍         | 14/300 [01:39<29:44,  6.24s/it]train/val metrics at epoch 15 | loss : 1.04/1.01 | micro_F1 : 0.34/0.37:   5%|▌         | 15/300 [01:40<29:35,  6.23s/it]train/val metrics at epoch 16 | loss : 1.03/0.99 | micro_F1 : 0.34/0.28:   5%|▌         | 15/300 [01:46<29:35,  6.23s/it]train/val metrics at epoch 16 | loss : 1.03/0.99 | micro_F1 : 0.34/0.28:   5%|▌         | 16/300 [01:46<29:23,  6.21s/it]train/val metrics at epoch 17 | loss : 1.03/0.99 | micro_F1 : 0.34/0.24:   5%|▌         | 16/300 [01:52<29:23,  6.21s/it]train/val metrics at epoch 17 | loss : 1.03/0.99 | micro_F1 : 0.34/0.24:   6%|▌         | 17/300 [01:52<29:28,  6.25s/it]train/val metrics at epoch 18 | loss : 1.02/0.99 | micro_F1 : 0.34/0.29:   6%|▌         | 17/300 [01:58<29:28,  6.25s/it]train/val metrics at epoch 18 | loss : 1.02/0.99 | micro_F1 : 0.34/0.29:   6%|▌         | 18/300 [01:58<29:09,  6.20s/it]train/val metrics at epoch 19 | loss : 1.02/0.97 | micro_F1 : 0.35/0.28:   6%|▌         | 18/300 [02:04<29:09,  6.20s/it]train/val metrics at epoch 19 | loss : 1.02/0.97 | micro_F1 : 0.35/0.28:   6%|▋         | 19/300 [02:04<29:00,  6.19s/it]train/val metrics at epoch 20 | loss : 1.01/0.97 | micro_F1 : 0.35/0.32:   6%|▋         | 19/300 [02:10<29:00,  6.19s/it]train/val metrics at epoch 20 | loss : 1.01/0.97 | micro_F1 : 0.35/0.32:   7%|▋         | 20/300 [02:11<28:56,  6.20s/it]train/val metrics at epoch 21 | loss : 1.02/0.98 | micro_F1 : 0.35/0.25:   7%|▋         | 20/300 [02:17<28:56,  6.20s/it]train/val metrics at epoch 21 | loss : 1.02/0.98 | micro_F1 : 0.35/0.25:   7%|▋         | 21/300 [02:17<28:54,  6.22s/it]train/val metrics at epoch 22 | loss : 1.01/0.96 | micro_F1 : 0.35/0.28:   7%|▋         | 21/300 [02:23<28:54,  6.22s/it]train/val metrics at epoch 22 | loss : 1.01/0.96 | micro_F1 : 0.35/0.28:   7%|▋         | 22/300 [02:23<28:58,  6.25s/it]train/val metrics at epoch 23 | loss : 1.01/0.99 | micro_F1 : 0.35/0.22:   7%|▋         | 22/300 [02:29<28:58,  6.25s/it]train/val metrics at epoch 23 | loss : 1.01/0.99 | micro_F1 : 0.35/0.22:   8%|▊         | 23/300 [02:30<29:06,  6.31s/it]train/val metrics at epoch 24 | loss : 1.00/0.96 | micro_F1 : 0.35/0.34:   8%|▊         | 23/300 [02:36<29:06,  6.31s/it]train/val metrics at epoch 24 | loss : 1.00/0.96 | micro_F1 : 0.35/0.34:   8%|▊         | 24/300 [02:36<28:49,  6.27s/it]train/val metrics at epoch 25 | loss : 1.00/0.98 | micro_F1 : 0.35/0.22:   8%|▊         | 24/300 [02:42<28:49,  6.27s/it]train/val metrics at epoch 25 | loss : 1.00/0.98 | micro_F1 : 0.35/0.22:   8%|▊         | 25/300 [02:42<28:37,  6.24s/it]train/val metrics at epoch 26 | loss : 1.00/0.95 | micro_F1 : 0.35/0.31:   8%|▊         | 25/300 [02:48<28:37,  6.24s/it]train/val metrics at epoch 26 | loss : 1.00/0.95 | micro_F1 : 0.35/0.31:   9%|▊         | 26/300 [02:48<28:35,  6.26s/it]train/val metrics at epoch 27 | loss : 0.99/0.95 | micro_F1 : 0.36/0.30:   9%|▊         | 26/300 [02:54<28:35,  6.26s/it]train/val metrics at epoch 27 | loss : 0.99/0.95 | micro_F1 : 0.36/0.30:   9%|▉         | 27/300 [02:54<28:14,  6.21s/it]train/val metrics at epoch 28 | loss : 0.99/0.95 | micro_F1 : 0.36/0.32:   9%|▉         | 27/300 [03:00<28:14,  6.21s/it]train/val metrics at epoch 28 | loss : 0.99/0.95 | micro_F1 : 0.36/0.32:   9%|▉         | 28/300 [03:01<28:10,  6.21s/it]train/val metrics at epoch 29 | loss : 0.99/0.96 | micro_F1 : 0.36/0.26:   9%|▉         | 28/300 [03:07<28:10,  6.21s/it]train/val metrics at epoch 29 | loss : 0.99/0.96 | micro_F1 : 0.36/0.26:  10%|▉         | 29/300 [03:07<27:58,  6.19s/it]train/val metrics at epoch 30 | loss : 0.99/0.95 | micro_F1 : 0.36/0.30:  10%|▉         | 29/300 [03:13<27:58,  6.19s/it]train/val metrics at epoch 30 | loss : 0.99/0.95 | micro_F1 : 0.36/0.30:  10%|█         | 30/300 [03:13<27:57,  6.21s/it]train/val metrics at epoch 31 | loss : 0.98/0.94 | micro_F1 : 0.36/0.34:  10%|█         | 30/300 [03:19<27:57,  6.21s/it]train/val metrics at epoch 31 | loss : 0.98/0.94 | micro_F1 : 0.36/0.34:  10%|█         | 31/300 [03:19<27:55,  6.23s/it]train/val metrics at epoch 32 | loss : 0.98/0.95 | micro_F1 : 0.36/0.29:  10%|█         | 31/300 [03:25<27:55,  6.23s/it]train/val metrics at epoch 32 | loss : 0.98/0.95 | micro_F1 : 0.36/0.29:  11%|█         | 32/300 [03:25<27:33,  6.17s/it]train/val metrics at epoch 33 | loss : 0.98/0.94 | micro_F1 : 0.36/0.34:  11%|█         | 32/300 [03:31<27:33,  6.17s/it]train/val metrics at epoch 33 | loss : 0.98/0.94 | micro_F1 : 0.36/0.34:  11%|█         | 33/300 [03:31<27:23,  6.15s/it]train/val metrics at epoch 34 | loss : 0.98/0.95 | micro_F1 : 0.36/0.29:  11%|█         | 33/300 [03:38<27:23,  6.15s/it]train/val metrics at epoch 34 | loss : 0.98/0.95 | micro_F1 : 0.36/0.29:  11%|█▏        | 34/300 [03:38<27:33,  6.22s/it]train/val metrics at epoch 35 | loss : 0.98/0.94 | micro_F1 : 0.36/0.34:  11%|█▏        | 34/300 [03:44<27:33,  6.22s/it]train/val metrics at epoch 35 | loss : 0.98/0.94 | micro_F1 : 0.36/0.34:  12%|█▏        | 35/300 [03:44<27:27,  6.22s/it]train/val metrics at epoch 36 | loss : 0.98/0.95 | micro_F1 : 0.36/0.30:  12%|█▏        | 35/300 [03:50<27:27,  6.22s/it]train/val metrics at epoch 36 | loss : 0.98/0.95 | micro_F1 : 0.36/0.30:  12%|█▏        | 36/300 [03:50<27:37,  6.28s/it]train/val metrics at epoch 37 | loss : 0.98/0.94 | micro_F1 : 0.36/0.32:  12%|█▏        | 36/300 [03:56<27:37,  6.28s/it]train/val metrics at epoch 37 | loss : 0.98/0.94 | micro_F1 : 0.36/0.32:  12%|█▏        | 37/300 [03:57<27:19,  6.23s/it]train/val metrics at epoch 38 | loss : 0.97/0.94 | micro_F1 : 0.36/0.32:  12%|█▏        | 37/300 [04:03<27:19,  6.23s/it]train/val metrics at epoch 38 | loss : 0.97/0.94 | micro_F1 : 0.36/0.32:  13%|█▎        | 38/300 [04:03<27:16,  6.24s/it]train/val metrics at epoch 39 | loss : 0.97/0.94 | micro_F1 : 0.36/0.29:  13%|█▎        | 38/300 [04:09<27:16,  6.24s/it]train/val metrics at epoch 39 | loss : 0.97/0.94 | micro_F1 : 0.36/0.29:  13%|█▎        | 39/300 [04:09<27:04,  6.22s/it]train/val metrics at epoch 40 | loss : 0.97/0.94 | micro_F1 : 0.36/0.29:  13%|█▎        | 39/300 [04:15<27:04,  6.22s/it]train/val metrics at epoch 40 | loss : 0.97/0.94 | micro_F1 : 0.36/0.29:  13%|█▎        | 40/300 [04:15<27:03,  6.25s/it]train/val metrics at epoch 41 | loss : 0.97/0.95 | micro_F1 : 0.36/0.31:  13%|█▎        | 40/300 [04:21<27:03,  6.25s/it]train/val metrics at epoch 41 | loss : 0.97/0.95 | micro_F1 : 0.36/0.31:  14%|█▎        | 41/300 [04:22<27:14,  6.31s/it]train/val metrics at epoch 42 | loss : 0.97/0.95 | micro_F1 : 0.36/0.30:  14%|█▎        | 41/300 [04:28<27:14,  6.31s/it]train/val metrics at epoch 42 | loss : 0.97/0.95 | micro_F1 : 0.36/0.30:  14%|█▍        | 42/300 [04:28<27:12,  6.33s/it]train/val metrics at epoch 43 | loss : 0.97/0.95 | micro_F1 : 0.36/0.32:  14%|█▍        | 42/300 [04:34<27:12,  6.33s/it]train/val metrics at epoch 43 | loss : 0.97/0.95 | micro_F1 : 0.36/0.32:  14%|█▍        | 43/300 [04:34<26:50,  6.27s/it]train/val metrics at epoch 44 | loss : 0.97/0.94 | micro_F1 : 0.36/0.30:  14%|█▍        | 43/300 [04:40<26:50,  6.27s/it]train/val metrics at epoch 44 | loss : 0.97/0.94 | micro_F1 : 0.36/0.30:  15%|█▍        | 44/300 [04:41<26:48,  6.28s/it]train/val metrics at epoch 45 | loss : 0.97/0.95 | micro_F1 : 0.37/0.30:  15%|█▍        | 44/300 [04:46<26:48,  6.28s/it]train/val metrics at epoch 45 | loss : 0.97/0.95 | micro_F1 : 0.37/0.30:  15%|█▌        | 45/300 [04:47<26:28,  6.23s/it]train/val metrics at epoch 46 | loss : 0.97/0.93 | micro_F1 : 0.36/0.28:  15%|█▌        | 45/300 [04:53<26:28,  6.23s/it]train/val metrics at epoch 46 | loss : 0.97/0.93 | micro_F1 : 0.36/0.28:  15%|█▌        | 46/300 [04:53<26:10,  6.18s/it]train/val metrics at epoch 47 | loss : 0.97/0.94 | micro_F1 : 0.36/0.32:  15%|█▌        | 46/300 [04:59<26:10,  6.18s/it]train/val metrics at epoch 47 | loss : 0.97/0.94 | micro_F1 : 0.36/0.32:  16%|█▌        | 47/300 [04:59<26:14,  6.22s/it]train/val metrics at epoch 48 | loss : 0.97/0.95 | micro_F1 : 0.37/0.30:  16%|█▌        | 47/300 [05:05<26:14,  6.22s/it]train/val metrics at epoch 48 | loss : 0.97/0.95 | micro_F1 : 0.37/0.30:  16%|█▌        | 48/300 [05:05<26:03,  6.20s/it]train/val metrics at epoch 49 | loss : 0.97/0.94 | micro_F1 : 0.37/0.33:  16%|█▌        | 48/300 [05:11<26:03,  6.20s/it]train/val metrics at epoch 49 | loss : 0.97/0.94 | micro_F1 : 0.37/0.33:  16%|█▋        | 49/300 [05:12<26:08,  6.25s/it]train/val metrics at epoch 50 | loss : 0.96/0.94 | micro_F1 : 0.37/0.27:  16%|█▋        | 49/300 [05:18<26:08,  6.25s/it]train/val metrics at epoch 50 | loss : 0.96/0.94 | micro_F1 : 0.37/0.27:  17%|█▋        | 50/300 [05:18<26:00,  6.24s/it]train/val metrics at epoch 51 | loss : 0.96/0.95 | micro_F1 : 0.36/0.31:  17%|█▋        | 50/300 [05:24<26:00,  6.24s/it]train/val metrics at epoch 51 | loss : 0.96/0.95 | micro_F1 : 0.36/0.31:  17%|█▋        | 51/300 [05:24<25:42,  6.20s/it]train/val metrics at epoch 52 | loss : 0.96/0.94 | micro_F1 : 0.37/0.31:  17%|█▋        | 51/300 [05:30<25:42,  6.20s/it]train/val metrics at epoch 52 | loss : 0.96/0.94 | micro_F1 : 0.37/0.31:  17%|█▋        | 52/300 [05:30<25:27,  6.16s/it]train/val metrics at epoch 53 | loss : 0.96/0.93 | micro_F1 : 0.37/0.31:  17%|█▋        | 52/300 [05:36<25:27,  6.16s/it]train/val metrics at epoch 53 | loss : 0.96/0.93 | micro_F1 : 0.37/0.31:  18%|█▊        | 53/300 [05:36<25:47,  6.27s/it]train/val metrics at epoch 54 | loss : 0.96/0.93 | micro_F1 : 0.36/0.31:  18%|█▊        | 53/300 [05:43<25:47,  6.27s/it]train/val metrics at epoch 54 | loss : 0.96/0.93 | micro_F1 : 0.36/0.31:  18%|█▊        | 54/300 [05:43<25:44,  6.28s/it]train/val metrics at epoch 55 | loss : 0.96/0.94 | micro_F1 : 0.37/0.31:  18%|█▊        | 54/300 [05:49<25:44,  6.28s/it]train/val metrics at epoch 55 | loss : 0.96/0.94 | micro_F1 : 0.37/0.31:  18%|█▊        | 55/300 [05:49<25:22,  6.21s/it]train/val metrics at epoch 56 | loss : 0.96/0.94 | micro_F1 : 0.36/0.30:  18%|█▊        | 55/300 [05:55<25:22,  6.21s/it]train/val metrics at epoch 56 | loss : 0.96/0.94 | micro_F1 : 0.36/0.30:  19%|█▊        | 56/300 [05:55<25:15,  6.21s/it]train/val metrics at epoch 57 | loss : 0.96/0.93 | micro_F1 : 0.37/0.32:  19%|█▊        | 56/300 [06:01<25:15,  6.21s/it]train/val metrics at epoch 57 | loss : 0.96/0.93 | micro_F1 : 0.37/0.32:  19%|█▉        | 57/300 [06:01<25:04,  6.19s/it]train/val metrics at epoch 58 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  19%|█▉        | 57/300 [06:07<25:04,  6.19s/it]train/val metrics at epoch 58 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  19%|█▉        | 58/300 [06:07<25:01,  6.20s/it]train/val metrics at epoch 59 | loss : 0.96/0.93 | micro_F1 : 0.37/0.32:  19%|█▉        | 58/300 [06:14<25:01,  6.20s/it]train/val metrics at epoch 59 | loss : 0.96/0.93 | micro_F1 : 0.37/0.32:  20%|█▉        | 59/300 [06:14<25:09,  6.26s/it]train/val metrics at epoch 60 | loss : 0.96/0.93 | micro_F1 : 0.37/0.33:  20%|█▉        | 59/300 [06:20<25:09,  6.26s/it]train/val metrics at epoch 60 | loss : 0.96/0.93 | micro_F1 : 0.37/0.33:  20%|██        | 60/300 [06:20<25:07,  6.28s/it]train/val metrics at epoch 61 | loss : 0.96/0.93 | micro_F1 : 0.36/0.30:  20%|██        | 60/300 [06:26<25:07,  6.28s/it]train/val metrics at epoch 61 | loss : 0.96/0.93 | micro_F1 : 0.36/0.30:  20%|██        | 61/300 [06:26<24:51,  6.24s/it]train/val metrics at epoch 62 | loss : 0.95/0.94 | micro_F1 : 0.37/0.29:  20%|██        | 61/300 [06:32<24:51,  6.24s/it]train/val metrics at epoch 62 | loss : 0.95/0.94 | micro_F1 : 0.37/0.29:  21%|██        | 62/300 [06:33<24:44,  6.24s/it]train/val metrics at epoch 63 | loss : 0.95/0.93 | micro_F1 : 0.37/0.33:  21%|██        | 62/300 [06:38<24:44,  6.24s/it]train/val metrics at epoch 63 | loss : 0.95/0.93 | micro_F1 : 0.37/0.33:  21%|██        | 63/300 [06:39<24:23,  6.18s/it]train/val metrics at epoch 64 | loss : 0.96/0.93 | micro_F1 : 0.37/0.31:  21%|██        | 63/300 [06:45<24:23,  6.18s/it]train/val metrics at epoch 64 | loss : 0.96/0.93 | micro_F1 : 0.37/0.31:  21%|██▏       | 64/300 [06:45<24:34,  6.25s/it]train/val metrics at epoch 65 | loss : 0.96/0.94 | micro_F1 : 0.36/0.30:  21%|██▏       | 64/300 [06:51<24:34,  6.25s/it]train/val metrics at epoch 65 | loss : 0.96/0.94 | micro_F1 : 0.36/0.30:  22%|██▏       | 65/300 [06:51<24:17,  6.20s/it]train/val metrics at epoch 66 | loss : 0.95/0.92 | micro_F1 : 0.37/0.32:  22%|██▏       | 65/300 [06:57<24:17,  6.20s/it]train/val metrics at epoch 66 | loss : 0.95/0.92 | micro_F1 : 0.37/0.32:  22%|██▏       | 66/300 [06:57<24:20,  6.24s/it]train/val metrics at epoch 67 | loss : 0.95/0.94 | micro_F1 : 0.37/0.32:  22%|██▏       | 66/300 [07:03<24:20,  6.24s/it]train/val metrics at epoch 67 | loss : 0.95/0.94 | micro_F1 : 0.37/0.32:  22%|██▏       | 67/300 [07:04<24:06,  6.21s/it]train/val metrics at epoch 68 | loss : 0.95/0.94 | micro_F1 : 0.37/0.31:  22%|██▏       | 67/300 [07:10<24:06,  6.21s/it]train/val metrics at epoch 68 | loss : 0.95/0.94 | micro_F1 : 0.37/0.31:  23%|██▎       | 68/300 [07:10<24:11,  6.26s/it]train/val metrics at epoch 69 | loss : 0.95/0.94 | micro_F1 : 0.37/0.30:  23%|██▎       | 68/300 [07:16<24:11,  6.26s/it]train/val metrics at epoch 69 | loss : 0.95/0.94 | micro_F1 : 0.37/0.30:  23%|██▎       | 69/300 [07:16<23:55,  6.21s/it]train/val metrics at epoch 70 | loss : 0.95/0.93 | micro_F1 : 0.37/0.31:  23%|██▎       | 69/300 [07:22<23:55,  6.21s/it]train/val metrics at epoch 70 | loss : 0.95/0.93 | micro_F1 : 0.37/0.31:  23%|██▎       | 70/300 [07:22<23:39,  6.17s/it]train/val metrics at epoch 71 | loss : 0.95/0.92 | micro_F1 : 0.37/0.31:  23%|██▎       | 70/300 [07:28<23:39,  6.17s/it]train/val metrics at epoch 71 | loss : 0.95/0.92 | micro_F1 : 0.37/0.31:  24%|██▎       | 71/300 [07:28<23:24,  6.13s/it]train/val metrics at epoch 72 | loss : 0.95/0.94 | micro_F1 : 0.37/0.34:  24%|██▎       | 71/300 [07:34<23:24,  6.13s/it]train/val metrics at epoch 72 | loss : 0.95/0.94 | micro_F1 : 0.37/0.34:  24%|██▍       | 72/300 [07:34<23:20,  6.14s/it]train/val metrics at epoch 73 | loss : 0.95/0.94 | micro_F1 : 0.37/0.31:  24%|██▍       | 72/300 [07:40<23:20,  6.14s/it]train/val metrics at epoch 73 | loss : 0.95/0.94 | micro_F1 : 0.37/0.31:  24%|██▍       | 73/300 [07:40<23:14,  6.14s/it]train/val metrics at epoch 74 | loss : 0.95/0.93 | micro_F1 : 0.37/0.31:  24%|██▍       | 73/300 [07:46<23:14,  6.14s/it]train/val metrics at epoch 74 | loss : 0.95/0.93 | micro_F1 : 0.37/0.31:  25%|██▍       | 74/300 [07:47<23:14,  6.17s/it]train/val metrics at epoch 75 | loss : 0.95/0.94 | micro_F1 : 0.37/0.31:  25%|██▍       | 74/300 [07:53<23:14,  6.17s/it]train/val metrics at epoch 75 | loss : 0.95/0.94 | micro_F1 : 0.37/0.31:  25%|██▌       | 75/300 [07:53<23:12,  6.19s/it]train/val metrics at epoch 76 | loss : 0.95/0.94 | micro_F1 : 0.37/0.32:  25%|██▌       | 75/300 [07:59<23:12,  6.19s/it]train/val metrics at epoch 76 | loss : 0.95/0.94 | micro_F1 : 0.37/0.32:  25%|██▌       | 75/300 [07:59<23:59,  6.40s/it]
wandb: Currently logged in as: tha-santacruz (msc-nicola). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/santacro/masters_thesis/fusion_tuning/wandb/run-20230626_154456-5exwojdx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run denim-morning-9
wandb: ⭐️ View project at https://wandb.ai/msc-nicola/test_fusion_tuning
wandb: 🚀 View run at https://wandb.ai/msc-nicola/test_fusion_tuning/runs/5exwojdx
Running job on GPU : Tesla V100-PCIE-32GB
Namespace(BATCH_SIZE=128, CHECKPOINTS_PATH='/scratch/izar/santacro/checkpoints/', DATASET_PATH='/scratch/izar/santacro/final_data/', DEVICE='cuda:0', EMBEDDING='longformer', EPOCH_NUM=300, FRACTION=40, FUSION='sum', HIDDEN_SIZE=8192, LEARNING_RATE=1e-05, LEVEL='L1', LOAD_CHECKPOINT='yes', MERGE_METHOD='fusion', MIN_LEARNING_RATE=1e-06, NORMALIZE='no', NUM_WORKERS=8, RANDOM_STATE=1, RUN_MODE='test', SAVE_CHECKPOINTS='yes', SPLITTING='species', TARGET_BASE='set', WANDB_ENTITY='msc-nicola', WANDB_LOGS='yes', WANDB_PROJECT='fusion_tuning')
Loaded model state dict from file /scratch/izar/santacro/checkpoints/temp.pth
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     test loss ▁
wandb: test macro F1 ▁
wandb:  test macro H ▁
wandb: test micro F1 ▁
wandb: 
wandb: Run summary:
wandb:     test loss 7.48365
wandb: test macro F1 0.1945
wandb:  test macro H 5.94683
wandb: test micro F1 0.27114
wandb: 
wandb: 🚀 View run denim-morning-9 at: https://wandb.ai/msc-nicola/test_fusion_tuning/runs/5exwojdx
wandb: Synced 4 W&B file(s), 10 media file(s), 1 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230626_154456-5exwojdx/logs
Running job on GPU : Tesla V100-PCIE-32GB
Namespace(BATCH_SIZE=128, CHECKPOINTS_PATH='/scratch/izar/santacro/checkpoints/', DATASET_PATH='/scratch/izar/santacro/final_data/', DEVICE='cuda:0', EMBEDDING='longformer', EPOCH_NUM=300, FRACTION=40, FUSION='sum', HIDDEN_SIZE=8192, LEARNING_RATE=1e-05, LEVEL='L1', LOAD_CHECKPOINT='no', MERGE_METHOD='fusion', MIN_LEARNING_RATE=1e-06, NORMALIZE='yes', NUM_WORKERS=8, RANDOM_STATE=1, RUN_MODE='train', SAVE_CHECKPOINTS='yes', SPLITTING='species', TARGET_BASE='set', WANDB_ENTITY='msc-nicola', WANDB_LOGS='no', WANDB_PROJECT='fusion_tuning')
  0%|          | 0/300 [00:00<?, ?it/s]train/val metrics at epoch 1 | loss : 1.20/1.06 | micro_F1 : 0.19/0.16:   0%|          | 0/300 [00:06<?, ?it/s]train/val metrics at epoch 1 | loss : 1.20/1.06 | micro_F1 : 0.19/0.16:   0%|          | 1/300 [00:06<34:03,  6.83s/it]train/val metrics at epoch 2 | loss : 1.19/1.05 | micro_F1 : 0.20/0.17:   0%|          | 1/300 [00:12<34:03,  6.83s/it]train/val metrics at epoch 2 | loss : 1.19/1.05 | micro_F1 : 0.20/0.17:   1%|          | 2/300 [00:13<32:26,  6.53s/it]train/val metrics at epoch 3 | loss : 1.18/1.05 | micro_F1 : 0.21/0.19:   1%|          | 2/300 [00:19<32:26,  6.53s/it]train/val metrics at epoch 3 | loss : 1.18/1.05 | micro_F1 : 0.21/0.19:   1%|          | 3/300 [00:19<31:55,  6.45s/it]train/val metrics at epoch 4 | loss : 1.17/1.05 | micro_F1 : 0.22/0.19:   1%|          | 3/300 [00:25<31:55,  6.45s/it]train/val metrics at epoch 4 | loss : 1.17/1.05 | micro_F1 : 0.22/0.19:   1%|▏         | 4/300 [00:25<31:15,  6.33s/it]train/val metrics at epoch 5 | loss : 1.16/1.04 | micro_F1 : 0.23/0.20:   1%|▏         | 4/300 [00:31<31:15,  6.33s/it]train/val metrics at epoch 5 | loss : 1.16/1.04 | micro_F1 : 0.23/0.20:   2%|▏         | 5/300 [00:31<30:46,  6.26s/it]train/val metrics at epoch 6 | loss : 1.15/1.04 | micro_F1 : 0.24/0.22:   2%|▏         | 5/300 [00:37<30:46,  6.26s/it]train/val metrics at epoch 6 | loss : 1.15/1.04 | micro_F1 : 0.24/0.22:   2%|▏         | 6/300 [00:37<30:24,  6.21s/it]train/val metrics at epoch 7 | loss : 1.14/1.02 | micro_F1 : 0.24/0.22:   2%|▏         | 6/300 [00:44<30:24,  6.21s/it]train/val metrics at epoch 7 | loss : 1.14/1.02 | micro_F1 : 0.24/0.22:   2%|▏         | 7/300 [00:44<30:27,  6.24s/it]train/val metrics at epoch 8 | loss : 1.13/1.01 | micro_F1 : 0.26/0.25:   2%|▏         | 7/300 [00:50<30:27,  6.24s/it]train/val metrics at epoch 8 | loss : 1.13/1.01 | micro_F1 : 0.26/0.25:   3%|▎         | 8/300 [00:50<30:21,  6.24s/it]train/val metrics at epoch 9 | loss : 1.12/0.99 | micro_F1 : 0.27/0.26:   3%|▎         | 8/300 [00:56<30:21,  6.24s/it]train/val metrics at epoch 9 | loss : 1.12/0.99 | micro_F1 : 0.27/0.26:   3%|▎         | 9/300 [00:56<30:32,  6.30s/it]train/val metrics at epoch 10 | loss : 1.11/0.99 | micro_F1 : 0.28/0.27:   3%|▎         | 9/300 [01:02<30:32,  6.30s/it]train/val metrics at epoch 10 | loss : 1.11/0.99 | micro_F1 : 0.28/0.27:   3%|▎         | 10/300 [01:03<30:23,  6.29s/it]train/val metrics at epoch 11 | loss : 1.10/0.97 | micro_F1 : 0.29/0.30:   3%|▎         | 10/300 [01:09<30:23,  6.29s/it]train/val metrics at epoch 11 | loss : 1.10/0.97 | micro_F1 : 0.29/0.30:   4%|▎         | 11/300 [01:09<30:05,  6.25s/it]train/val metrics at epoch 12 | loss : 1.09/0.97 | micro_F1 : 0.30/0.30:   4%|▎         | 11/300 [01:15<30:05,  6.25s/it]train/val metrics at epoch 12 | loss : 1.09/0.97 | micro_F1 : 0.30/0.30:   4%|▍         | 12/300 [01:15<29:53,  6.23s/it]train/val metrics at epoch 13 | loss : 1.08/0.96 | micro_F1 : 0.31/0.31:   4%|▍         | 12/300 [01:21<29:53,  6.23s/it]train/val metrics at epoch 13 | loss : 1.08/0.96 | micro_F1 : 0.31/0.31:   4%|▍         | 13/300 [01:21<29:56,  6.26s/it]train/val metrics at epoch 14 | loss : 1.07/0.96 | micro_F1 : 0.32/0.31:   4%|▍         | 13/300 [01:27<29:56,  6.26s/it]train/val metrics at epoch 14 | loss : 1.07/0.96 | micro_F1 : 0.32/0.31:   5%|▍         | 14/300 [01:28<29:49,  6.26s/it]train/val metrics at epoch 15 | loss : 1.06/0.95 | micro_F1 : 0.32/0.32:   5%|▍         | 14/300 [01:34<29:49,  6.26s/it]train/val metrics at epoch 15 | loss : 1.06/0.95 | micro_F1 : 0.32/0.32:   5%|▌         | 15/300 [01:34<29:55,  6.30s/it]train/val metrics at epoch 16 | loss : 1.05/0.95 | micro_F1 : 0.32/0.32:   5%|▌         | 15/300 [01:40<29:55,  6.30s/it]train/val metrics at epoch 16 | loss : 1.05/0.95 | micro_F1 : 0.32/0.32:   5%|▌         | 16/300 [01:40<29:33,  6.25s/it]train/val metrics at epoch 17 | loss : 1.04/0.94 | micro_F1 : 0.33/0.34:   5%|▌         | 16/300 [01:46<29:33,  6.25s/it]train/val metrics at epoch 17 | loss : 1.04/0.94 | micro_F1 : 0.33/0.34:   6%|▌         | 17/300 [01:47<29:49,  6.32s/it]train/val metrics at epoch 18 | loss : 1.03/0.94 | micro_F1 : 0.33/0.33:   6%|▌         | 17/300 [01:53<29:49,  6.32s/it]train/val metrics at epoch 18 | loss : 1.03/0.94 | micro_F1 : 0.33/0.33:   6%|▌         | 18/300 [01:53<29:50,  6.35s/it]train/val metrics at epoch 19 | loss : 1.03/0.94 | micro_F1 : 0.34/0.33:   6%|▌         | 18/300 [01:59<29:50,  6.35s/it]train/val metrics at epoch 19 | loss : 1.03/0.94 | micro_F1 : 0.34/0.33:   6%|▋         | 19/300 [01:59<29:43,  6.35s/it]train/val metrics at epoch 20 | loss : 1.02/0.94 | micro_F1 : 0.34/0.33:   6%|▋         | 19/300 [02:05<29:43,  6.35s/it]train/val metrics at epoch 20 | loss : 1.02/0.94 | micro_F1 : 0.34/0.33:   7%|▋         | 20/300 [02:06<29:31,  6.33s/it]train/val metrics at epoch 21 | loss : 1.01/0.93 | micro_F1 : 0.34/0.33:   7%|▋         | 20/300 [02:12<29:31,  6.33s/it]train/val metrics at epoch 21 | loss : 1.01/0.93 | micro_F1 : 0.34/0.33:   7%|▋         | 21/300 [02:12<29:32,  6.35s/it]train/val metrics at epoch 22 | loss : 1.01/0.93 | micro_F1 : 0.34/0.35:   7%|▋         | 21/300 [02:18<29:32,  6.35s/it]train/val metrics at epoch 22 | loss : 1.01/0.93 | micro_F1 : 0.34/0.35:   7%|▋         | 22/300 [02:18<29:12,  6.30s/it]train/val metrics at epoch 23 | loss : 1.00/0.93 | micro_F1 : 0.35/0.33:   7%|▋         | 22/300 [02:24<29:12,  6.30s/it]train/val metrics at epoch 23 | loss : 1.00/0.93 | micro_F1 : 0.35/0.33:   8%|▊         | 23/300 [02:25<29:19,  6.35s/it]train/val metrics at epoch 24 | loss : 0.99/0.93 | micro_F1 : 0.34/0.35:   8%|▊         | 23/300 [02:31<29:19,  6.35s/it]train/val metrics at epoch 24 | loss : 0.99/0.93 | micro_F1 : 0.34/0.35:   8%|▊         | 24/300 [02:31<29:04,  6.32s/it]train/val metrics at epoch 25 | loss : 0.99/0.92 | micro_F1 : 0.35/0.33:   8%|▊         | 24/300 [02:37<29:04,  6.32s/it]train/val metrics at epoch 25 | loss : 0.99/0.92 | micro_F1 : 0.35/0.33:   8%|▊         | 25/300 [02:37<28:52,  6.30s/it]train/val metrics at epoch 26 | loss : 0.98/0.92 | micro_F1 : 0.35/0.33:   8%|▊         | 25/300 [02:43<28:52,  6.30s/it]train/val metrics at epoch 26 | loss : 0.98/0.92 | micro_F1 : 0.35/0.33:   9%|▊         | 26/300 [02:44<29:00,  6.35s/it]train/val metrics at epoch 27 | loss : 0.97/0.92 | micro_F1 : 0.36/0.33:   9%|▊         | 26/300 [02:50<29:00,  6.35s/it]train/val metrics at epoch 27 | loss : 0.97/0.92 | micro_F1 : 0.36/0.33:   9%|▉         | 27/300 [02:50<29:00,  6.38s/it]train/val metrics at epoch 28 | loss : 0.97/0.93 | micro_F1 : 0.36/0.33:   9%|▉         | 27/300 [02:56<29:00,  6.38s/it]train/val metrics at epoch 28 | loss : 0.97/0.93 | micro_F1 : 0.36/0.33:   9%|▉         | 28/300 [02:57<29:26,  6.49s/it]train/val metrics at epoch 29 | loss : 0.97/0.92 | micro_F1 : 0.35/0.33:   9%|▉         | 28/300 [03:03<29:26,  6.49s/it]train/val metrics at epoch 29 | loss : 0.97/0.92 | micro_F1 : 0.35/0.33:  10%|▉         | 29/300 [03:03<28:59,  6.42s/it]train/val metrics at epoch 30 | loss : 0.96/0.93 | micro_F1 : 0.36/0.33:  10%|▉         | 29/300 [03:09<28:59,  6.42s/it]train/val metrics at epoch 30 | loss : 0.96/0.93 | micro_F1 : 0.36/0.33:  10%|█         | 30/300 [03:09<28:38,  6.36s/it]train/val metrics at epoch 31 | loss : 0.96/0.92 | micro_F1 : 0.36/0.33:  10%|█         | 30/300 [03:15<28:38,  6.36s/it]train/val metrics at epoch 31 | loss : 0.96/0.92 | micro_F1 : 0.36/0.33:  10%|█         | 31/300 [03:15<28:15,  6.30s/it]train/val metrics at epoch 32 | loss : 0.96/0.93 | micro_F1 : 0.36/0.33:  10%|█         | 31/300 [03:22<28:15,  6.30s/it]train/val metrics at epoch 32 | loss : 0.96/0.93 | micro_F1 : 0.36/0.33:  11%|█         | 32/300 [03:22<28:05,  6.29s/it]train/val metrics at epoch 33 | loss : 0.96/0.92 | micro_F1 : 0.36/0.33:  11%|█         | 32/300 [03:28<28:05,  6.29s/it]train/val metrics at epoch 33 | loss : 0.96/0.92 | micro_F1 : 0.36/0.33:  11%|█         | 33/300 [03:28<27:51,  6.26s/it]train/val metrics at epoch 34 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  11%|█         | 33/300 [03:34<27:51,  6.26s/it]train/val metrics at epoch 34 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  11%|█▏        | 34/300 [03:34<27:52,  6.29s/it]train/val metrics at epoch 35 | loss : 0.96/0.92 | micro_F1 : 0.36/0.33:  11%|█▏        | 34/300 [03:40<27:52,  6.29s/it]train/val metrics at epoch 35 | loss : 0.96/0.92 | micro_F1 : 0.36/0.33:  12%|█▏        | 35/300 [03:41<27:51,  6.31s/it]train/val metrics at epoch 36 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  12%|█▏        | 35/300 [03:47<27:51,  6.31s/it]train/val metrics at epoch 36 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  12%|█▏        | 36/300 [03:47<27:44,  6.31s/it]train/val metrics at epoch 37 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  12%|█▏        | 36/300 [03:53<27:44,  6.31s/it]train/val metrics at epoch 37 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  12%|█▏        | 37/300 [03:53<27:30,  6.28s/it]train/val metrics at epoch 38 | loss : 0.96/0.93 | micro_F1 : 0.36/0.33:  12%|█▏        | 37/300 [03:59<27:30,  6.28s/it]train/val metrics at epoch 38 | loss : 0.96/0.93 | micro_F1 : 0.36/0.33:  13%|█▎        | 38/300 [03:59<27:14,  6.24s/it]train/val metrics at epoch 39 | loss : 0.96/0.92 | micro_F1 : 0.36/0.32:  13%|█▎        | 38/300 [04:05<27:14,  6.24s/it]train/val metrics at epoch 39 | loss : 0.96/0.92 | micro_F1 : 0.36/0.32:  13%|█▎        | 39/300 [04:06<27:19,  6.28s/it]train/val metrics at epoch 40 | loss : 0.95/0.93 | micro_F1 : 0.36/0.32:  13%|█▎        | 39/300 [04:12<27:19,  6.28s/it]train/val metrics at epoch 40 | loss : 0.95/0.93 | micro_F1 : 0.36/0.32:  13%|█▎        | 40/300 [04:12<27:17,  6.30s/it]train/val metrics at epoch 41 | loss : 0.95/0.93 | micro_F1 : 0.36/0.32:  13%|█▎        | 40/300 [04:18<27:17,  6.30s/it]train/val metrics at epoch 41 | loss : 0.95/0.93 | micro_F1 : 0.36/0.32:  14%|█▎        | 41/300 [04:18<27:20,  6.34s/it]train/val metrics at epoch 42 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  14%|█▎        | 41/300 [04:24<27:20,  6.34s/it]train/val metrics at epoch 42 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  14%|█▍        | 42/300 [04:25<27:01,  6.29s/it]train/val metrics at epoch 43 | loss : 0.95/0.93 | micro_F1 : 0.36/0.32:  14%|█▍        | 42/300 [04:31<27:01,  6.29s/it]train/val metrics at epoch 43 | loss : 0.95/0.93 | micro_F1 : 0.36/0.32:  14%|█▍        | 42/300 [04:31<27:48,  6.47s/it]
wandb: Currently logged in as: tha-santacruz (msc-nicola). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/santacro/masters_thesis/fusion_tuning/wandb/run-20230626_155031-rpzdmpf3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run tough-sea-15
wandb: ⭐️ View project at https://wandb.ai/msc-nicola/test_fusion_tuning
wandb: 🚀 View run at https://wandb.ai/msc-nicola/test_fusion_tuning/runs/rpzdmpf3
Running job on GPU : Tesla V100-PCIE-32GB
Namespace(BATCH_SIZE=128, CHECKPOINTS_PATH='/scratch/izar/santacro/checkpoints/', DATASET_PATH='/scratch/izar/santacro/final_data/', DEVICE='cuda:0', EMBEDDING='longformer', EPOCH_NUM=300, FRACTION=40, FUSION='sum', HIDDEN_SIZE=8192, LEARNING_RATE=1e-05, LEVEL='L1', LOAD_CHECKPOINT='yes', MERGE_METHOD='fusion', MIN_LEARNING_RATE=1e-06, NORMALIZE='yes', NUM_WORKERS=8, RANDOM_STATE=1, RUN_MODE='test', SAVE_CHECKPOINTS='yes', SPLITTING='species', TARGET_BASE='set', WANDB_ENTITY='msc-nicola', WANDB_LOGS='yes', WANDB_PROJECT='fusion_tuning')
Loaded model state dict from file /scratch/izar/santacro/checkpoints/temp.pth
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.047 MB of 0.189 MB uploaded (0.000 MB deduped)wandb: \ 0.070 MB of 0.189 MB uploaded (0.000 MB deduped)wandb: | 0.155 MB of 0.194 MB uploaded (0.000 MB deduped)wandb: / 0.194 MB of 0.194 MB uploaded (0.000 MB deduped)wandb: - 0.194 MB of 0.194 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:     test loss ▁
wandb: test macro F1 ▁
wandb:  test macro H ▁
wandb: test micro F1 ▁
wandb: 
wandb: Run summary:
wandb:     test loss 1.15061
wandb: test macro F1 0.24862
wandb:  test macro H 2.62364
wandb: test micro F1 0.32115
wandb: 
wandb: 🚀 View run tough-sea-15 at: https://wandb.ai/msc-nicola/test_fusion_tuning/runs/rpzdmpf3
wandb: Synced 4 W&B file(s), 10 media file(s), 1 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230626_155031-rpzdmpf3/logs
Running job on GPU : Tesla V100-PCIE-32GB
Namespace(BATCH_SIZE=128, CHECKPOINTS_PATH='/scratch/izar/santacro/checkpoints/', DATASET_PATH='/scratch/izar/santacro/final_data/', DEVICE='cuda:0', EMBEDDING='longformer', EPOCH_NUM=300, FRACTION=40, FUSION='max', HIDDEN_SIZE=8192, LEARNING_RATE=1e-05, LEVEL='L1', LOAD_CHECKPOINT='no', MERGE_METHOD='fusion', MIN_LEARNING_RATE=1e-06, NORMALIZE='no', NUM_WORKERS=8, RANDOM_STATE=1, RUN_MODE='train', SAVE_CHECKPOINTS='yes', SPLITTING='species', TARGET_BASE='set', WANDB_ENTITY='msc-nicola', WANDB_LOGS='no', WANDB_PROJECT='fusion_tuning')
  0%|          | 0/300 [00:00<?, ?it/s]train/val metrics at epoch 1 | loss : 1.16/1.05 | micro_F1 : 0.22/0.20:   0%|          | 0/300 [00:06<?, ?it/s]train/val metrics at epoch 1 | loss : 1.16/1.05 | micro_F1 : 0.22/0.20:   0%|          | 1/300 [00:06<34:35,  6.94s/it]train/val metrics at epoch 2 | loss : 1.11/1.03 | micro_F1 : 0.27/0.26:   0%|          | 1/300 [00:12<34:35,  6.94s/it]train/val metrics at epoch 2 | loss : 1.11/1.03 | micro_F1 : 0.27/0.26:   1%|          | 2/300 [00:13<32:03,  6.46s/it]train/val metrics at epoch 3 | loss : 1.08/1.01 | micro_F1 : 0.30/0.27:   1%|          | 2/300 [00:19<32:03,  6.46s/it]train/val metrics at epoch 3 | loss : 1.08/1.01 | micro_F1 : 0.30/0.27:   1%|          | 3/300 [00:19<31:46,  6.42s/it]train/val metrics at epoch 4 | loss : 1.06/1.01 | micro_F1 : 0.31/0.27:   1%|          | 3/300 [00:25<31:46,  6.42s/it]train/val metrics at epoch 4 | loss : 1.06/1.01 | micro_F1 : 0.31/0.27:   1%|▏         | 4/300 [00:25<31:04,  6.30s/it]train/val metrics at epoch 5 | loss : 1.04/0.99 | micro_F1 : 0.33/0.29:   1%|▏         | 4/300 [00:31<31:04,  6.30s/it]train/val metrics at epoch 5 | loss : 1.04/0.99 | micro_F1 : 0.33/0.29:   2%|▏         | 5/300 [00:31<30:39,  6.24s/it]train/val metrics at epoch 6 | loss : 1.02/0.99 | micro_F1 : 0.34/0.32:   2%|▏         | 5/300 [00:37<30:39,  6.24s/it]train/val metrics at epoch 6 | loss : 1.02/0.99 | micro_F1 : 0.34/0.32:   2%|▏         | 6/300 [00:37<30:31,  6.23s/it]train/val metrics at epoch 7 | loss : 1.00/0.98 | micro_F1 : 0.35/0.38:   2%|▏         | 6/300 [00:43<30:31,  6.23s/it]train/val metrics at epoch 7 | loss : 1.00/0.98 | micro_F1 : 0.35/0.38:   2%|▏         | 7/300 [00:44<30:20,  6.21s/it]train/val metrics at epoch 8 | loss : 0.98/0.96 | micro_F1 : 0.36/0.34:   2%|▏         | 7/300 [00:50<30:20,  6.21s/it]train/val metrics at epoch 8 | loss : 0.98/0.96 | micro_F1 : 0.36/0.34:   3%|▎         | 8/300 [00:50<30:22,  6.24s/it]train/val metrics at epoch 9 | loss : 0.96/0.95 | micro_F1 : 0.37/0.31:   3%|▎         | 8/300 [00:56<30:22,  6.24s/it]train/val metrics at epoch 9 | loss : 0.96/0.95 | micro_F1 : 0.37/0.31:   3%|▎         | 9/300 [00:56<30:06,  6.21s/it]train/val metrics at epoch 10 | loss : 0.94/0.94 | micro_F1 : 0.37/0.32:   3%|▎         | 9/300 [01:02<30:06,  6.21s/it]train/val metrics at epoch 10 | loss : 0.94/0.94 | micro_F1 : 0.37/0.32:   3%|▎         | 10/300 [01:02<29:54,  6.19s/it]train/val metrics at epoch 11 | loss : 0.93/0.93 | micro_F1 : 0.38/0.35:   3%|▎         | 10/300 [01:08<29:54,  6.19s/it]train/val metrics at epoch 11 | loss : 0.93/0.93 | micro_F1 : 0.38/0.35:   4%|▎         | 11/300 [01:08<29:53,  6.21s/it]train/val metrics at epoch 12 | loss : 0.92/0.95 | micro_F1 : 0.38/0.34:   4%|▎         | 11/300 [01:15<29:53,  6.21s/it]train/val metrics at epoch 12 | loss : 0.92/0.95 | micro_F1 : 0.38/0.34:   4%|▍         | 12/300 [01:15<30:00,  6.25s/it]train/val metrics at epoch 13 | loss : 0.90/0.93 | micro_F1 : 0.39/0.33:   4%|▍         | 12/300 [01:21<30:00,  6.25s/it]train/val metrics at epoch 13 | loss : 0.90/0.93 | micro_F1 : 0.39/0.33:   4%|▍         | 13/300 [01:21<29:48,  6.23s/it]train/val metrics at epoch 14 | loss : 0.89/1.05 | micro_F1 : 0.39/0.37:   4%|▍         | 13/300 [01:27<29:48,  6.23s/it]train/val metrics at epoch 14 | loss : 0.89/1.05 | micro_F1 : 0.39/0.37:   5%|▍         | 14/300 [01:27<29:38,  6.22s/it]train/val metrics at epoch 15 | loss : 0.88/0.94 | micro_F1 : 0.40/0.37:   5%|▍         | 14/300 [01:33<29:38,  6.22s/it]train/val metrics at epoch 15 | loss : 0.88/0.94 | micro_F1 : 0.40/0.37:   5%|▌         | 15/300 [01:33<29:42,  6.25s/it]train/val metrics at epoch 16 | loss : 0.86/0.95 | micro_F1 : 0.40/0.35:   5%|▌         | 15/300 [01:40<29:42,  6.25s/it]train/val metrics at epoch 16 | loss : 0.86/0.95 | micro_F1 : 0.40/0.35:   5%|▌         | 16/300 [01:40<29:37,  6.26s/it]train/val metrics at epoch 17 | loss : 0.85/0.93 | micro_F1 : 0.41/0.31:   5%|▌         | 16/300 [01:46<29:37,  6.26s/it]train/val metrics at epoch 17 | loss : 0.85/0.93 | micro_F1 : 0.41/0.31:   6%|▌         | 17/300 [01:46<29:36,  6.28s/it]train/val metrics at epoch 18 | loss : 0.85/0.95 | micro_F1 : 0.41/0.36:   6%|▌         | 17/300 [01:52<29:36,  6.28s/it]train/val metrics at epoch 18 | loss : 0.85/0.95 | micro_F1 : 0.41/0.36:   6%|▌         | 18/300 [01:52<29:15,  6.22s/it]train/val metrics at epoch 19 | loss : 0.84/0.93 | micro_F1 : 0.41/0.35:   6%|▌         | 18/300 [01:58<29:15,  6.22s/it]train/val metrics at epoch 19 | loss : 0.84/0.93 | micro_F1 : 0.41/0.35:   6%|▋         | 19/300 [01:58<28:56,  6.18s/it]train/val metrics at epoch 20 | loss : 0.83/0.93 | micro_F1 : 0.42/0.33:   6%|▋         | 19/300 [02:04<28:56,  6.18s/it]train/val metrics at epoch 20 | loss : 0.83/0.93 | micro_F1 : 0.42/0.33:   7%|▋         | 20/300 [02:04<28:42,  6.15s/it]train/val metrics at epoch 21 | loss : 0.83/0.93 | micro_F1 : 0.41/0.34:   7%|▋         | 20/300 [02:11<28:42,  6.15s/it]train/val metrics at epoch 21 | loss : 0.83/0.93 | micro_F1 : 0.41/0.34:   7%|▋         | 21/300 [02:11<29:05,  6.25s/it]train/val metrics at epoch 22 | loss : 0.83/0.92 | micro_F1 : 0.42/0.36:   7%|▋         | 21/300 [02:17<29:05,  6.25s/it]train/val metrics at epoch 22 | loss : 0.83/0.92 | micro_F1 : 0.42/0.36:   7%|▋         | 22/300 [02:17<28:50,  6.23s/it]train/val metrics at epoch 23 | loss : 0.82/0.93 | micro_F1 : 0.42/0.34:   7%|▋         | 22/300 [02:23<28:50,  6.23s/it]train/val metrics at epoch 23 | loss : 0.82/0.93 | micro_F1 : 0.42/0.34:   8%|▊         | 23/300 [02:23<28:49,  6.24s/it]train/val metrics at epoch 24 | loss : 0.82/0.92 | micro_F1 : 0.42/0.35:   8%|▊         | 23/300 [02:29<28:49,  6.24s/it]train/val metrics at epoch 24 | loss : 0.82/0.92 | micro_F1 : 0.42/0.35:   8%|▊         | 24/300 [02:29<28:39,  6.23s/it]train/val metrics at epoch 25 | loss : 0.82/0.92 | micro_F1 : 0.42/0.36:   8%|▊         | 24/300 [02:35<28:39,  6.23s/it]train/val metrics at epoch 25 | loss : 0.82/0.92 | micro_F1 : 0.42/0.36:   8%|▊         | 25/300 [02:36<28:20,  6.18s/it]train/val metrics at epoch 26 | loss : 0.82/0.92 | micro_F1 : 0.42/0.35:   8%|▊         | 25/300 [02:42<28:20,  6.18s/it]train/val metrics at epoch 26 | loss : 0.82/0.92 | micro_F1 : 0.42/0.35:   9%|▊         | 26/300 [02:42<28:19,  6.20s/it]train/val metrics at epoch 27 | loss : 0.82/0.93 | micro_F1 : 0.42/0.35:   9%|▊         | 26/300 [02:48<28:19,  6.20s/it]train/val metrics at epoch 27 | loss : 0.82/0.93 | micro_F1 : 0.42/0.35:   9%|▉         | 27/300 [02:48<28:31,  6.27s/it]train/val metrics at epoch 28 | loss : 0.82/0.93 | micro_F1 : 0.42/0.35:   9%|▉         | 27/300 [02:54<28:31,  6.27s/it]train/val metrics at epoch 28 | loss : 0.82/0.93 | micro_F1 : 0.42/0.35:   9%|▉         | 28/300 [02:55<28:42,  6.33s/it]train/val metrics at epoch 29 | loss : 0.81/0.92 | micro_F1 : 0.42/0.34:   9%|▉         | 28/300 [03:01<28:42,  6.33s/it]train/val metrics at epoch 29 | loss : 0.81/0.92 | micro_F1 : 0.42/0.34:  10%|▉         | 29/300 [03:01<28:27,  6.30s/it]train/val metrics at epoch 30 | loss : 0.81/0.92 | micro_F1 : 0.42/0.34:  10%|▉         | 29/300 [03:07<28:27,  6.30s/it]train/val metrics at epoch 30 | loss : 0.81/0.92 | micro_F1 : 0.42/0.34:  10%|█         | 30/300 [03:07<28:22,  6.30s/it]train/val metrics at epoch 31 | loss : 0.81/0.92 | micro_F1 : 0.43/0.36:  10%|█         | 30/300 [03:13<28:22,  6.30s/it]train/val metrics at epoch 31 | loss : 0.81/0.92 | micro_F1 : 0.43/0.36:  10%|█         | 31/300 [03:13<27:59,  6.24s/it]train/val metrics at epoch 32 | loss : 0.81/0.93 | micro_F1 : 0.43/0.36:  10%|█         | 31/300 [03:19<27:59,  6.24s/it]train/val metrics at epoch 32 | loss : 0.81/0.93 | micro_F1 : 0.43/0.36:  11%|█         | 32/300 [03:19<27:47,  6.22s/it]train/val metrics at epoch 33 | loss : 0.81/0.91 | micro_F1 : 0.42/0.34:  11%|█         | 32/300 [03:26<27:47,  6.22s/it]train/val metrics at epoch 33 | loss : 0.81/0.91 | micro_F1 : 0.42/0.34:  11%|█         | 33/300 [03:26<27:43,  6.23s/it]train/val metrics at epoch 34 | loss : 0.81/0.93 | micro_F1 : 0.43/0.36:  11%|█         | 33/300 [03:32<27:43,  6.23s/it]train/val metrics at epoch 34 | loss : 0.81/0.93 | micro_F1 : 0.43/0.36:  11%|█▏        | 34/300 [03:32<27:46,  6.26s/it]train/val metrics at epoch 35 | loss : 0.81/0.92 | micro_F1 : 0.42/0.35:  11%|█▏        | 34/300 [03:38<27:46,  6.26s/it]train/val metrics at epoch 35 | loss : 0.81/0.92 | micro_F1 : 0.42/0.35:  12%|█▏        | 35/300 [03:38<27:34,  6.24s/it]train/val metrics at epoch 36 | loss : 0.80/0.92 | micro_F1 : 0.43/0.35:  12%|█▏        | 35/300 [03:45<27:34,  6.24s/it]train/val metrics at epoch 36 | loss : 0.80/0.92 | micro_F1 : 0.43/0.35:  12%|█▏        | 36/300 [03:45<27:43,  6.30s/it]train/val metrics at epoch 37 | loss : 0.81/0.93 | micro_F1 : 0.43/0.35:  12%|█▏        | 36/300 [03:51<27:43,  6.30s/it]train/val metrics at epoch 37 | loss : 0.81/0.93 | micro_F1 : 0.43/0.35:  12%|█▏        | 37/300 [03:51<27:27,  6.27s/it]train/val metrics at epoch 38 | loss : 0.80/0.93 | micro_F1 : 0.43/0.36:  12%|█▏        | 37/300 [03:57<27:27,  6.27s/it]train/val metrics at epoch 38 | loss : 0.80/0.93 | micro_F1 : 0.43/0.36:  13%|█▎        | 38/300 [03:57<27:25,  6.28s/it]train/val metrics at epoch 39 | loss : 0.80/0.92 | micro_F1 : 0.43/0.34:  13%|█▎        | 38/300 [04:03<27:25,  6.28s/it]train/val metrics at epoch 39 | loss : 0.80/0.92 | micro_F1 : 0.43/0.34:  13%|█▎        | 39/300 [04:03<27:14,  6.26s/it]train/val metrics at epoch 40 | loss : 0.80/0.93 | micro_F1 : 0.43/0.34:  13%|█▎        | 39/300 [04:10<27:14,  6.26s/it]train/val metrics at epoch 40 | loss : 0.80/0.93 | micro_F1 : 0.43/0.34:  13%|█▎        | 40/300 [04:10<27:12,  6.28s/it]train/val metrics at epoch 41 | loss : 0.80/0.93 | micro_F1 : 0.43/0.35:  13%|█▎        | 40/300 [04:16<27:12,  6.28s/it]train/val metrics at epoch 41 | loss : 0.80/0.93 | micro_F1 : 0.43/0.35:  14%|█▎        | 41/300 [04:16<26:57,  6.25s/it]train/val metrics at epoch 42 | loss : 0.80/0.94 | micro_F1 : 0.43/0.35:  14%|█▎        | 41/300 [04:22<26:57,  6.25s/it]train/val metrics at epoch 42 | loss : 0.80/0.94 | micro_F1 : 0.43/0.35:  14%|█▍        | 42/300 [04:22<27:03,  6.29s/it]train/val metrics at epoch 43 | loss : 0.80/0.94 | micro_F1 : 0.43/0.36:  14%|█▍        | 42/300 [04:28<27:03,  6.29s/it]train/val metrics at epoch 43 | loss : 0.80/0.94 | micro_F1 : 0.43/0.36:  14%|█▍        | 42/300 [04:28<27:32,  6.40s/it]
wandb: Currently logged in as: tha-santacruz (msc-nicola). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/santacro/masters_thesis/fusion_tuning/wandb/run-20230626_155602-qqgcd290
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run frosty-capybara-17
wandb: ⭐️ View project at https://wandb.ai/msc-nicola/test_fusion_tuning
wandb: 🚀 View run at https://wandb.ai/msc-nicola/test_fusion_tuning/runs/qqgcd290
Running job on GPU : Tesla V100-PCIE-32GB
Namespace(BATCH_SIZE=128, CHECKPOINTS_PATH='/scratch/izar/santacro/checkpoints/', DATASET_PATH='/scratch/izar/santacro/final_data/', DEVICE='cuda:0', EMBEDDING='longformer', EPOCH_NUM=300, FRACTION=40, FUSION='max', HIDDEN_SIZE=8192, LEARNING_RATE=1e-05, LEVEL='L1', LOAD_CHECKPOINT='yes', MERGE_METHOD='fusion', MIN_LEARNING_RATE=1e-06, NORMALIZE='no', NUM_WORKERS=8, RANDOM_STATE=1, RUN_MODE='test', SAVE_CHECKPOINTS='yes', SPLITTING='species', TARGET_BASE='set', WANDB_ENTITY='msc-nicola', WANDB_LOGS='yes', WANDB_PROJECT='fusion_tuning')
Loaded model state dict from file /scratch/izar/santacro/checkpoints/temp.pth
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     test loss ▁
wandb: test macro F1 ▁
wandb:  test macro H ▁
wandb: test micro F1 ▁
wandb: 
wandb: Run summary:
wandb:     test loss 1.17526
wandb: test macro F1 0.27357
wandb:  test macro H 2.16262
wandb: test micro F1 0.34516
wandb: 
wandb: 🚀 View run frosty-capybara-17 at: https://wandb.ai/msc-nicola/test_fusion_tuning/runs/qqgcd290
wandb: Synced 4 W&B file(s), 10 media file(s), 1 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230626_155602-qqgcd290/logs
Running job on GPU : Tesla V100-PCIE-32GB
Namespace(BATCH_SIZE=128, CHECKPOINTS_PATH='/scratch/izar/santacro/checkpoints/', DATASET_PATH='/scratch/izar/santacro/final_data/', DEVICE='cuda:0', EMBEDDING='longformer', EPOCH_NUM=300, FRACTION=40, FUSION='max', HIDDEN_SIZE=8192, LEARNING_RATE=1e-05, LEVEL='L1', LOAD_CHECKPOINT='no', MERGE_METHOD='fusion', MIN_LEARNING_RATE=1e-06, NORMALIZE='yes', NUM_WORKERS=8, RANDOM_STATE=1, RUN_MODE='train', SAVE_CHECKPOINTS='yes', SPLITTING='species', TARGET_BASE='set', WANDB_ENTITY='msc-nicola', WANDB_LOGS='no', WANDB_PROJECT='fusion_tuning')
  0%|          | 0/300 [00:00<?, ?it/s]train/val metrics at epoch 1 | loss : 1.18/1.06 | micro_F1 : 0.21/0.17:   0%|          | 0/300 [00:06<?, ?it/s]train/val metrics at epoch 1 | loss : 1.18/1.06 | micro_F1 : 0.21/0.17:   0%|          | 1/300 [00:06<33:00,  6.62s/it]train/val metrics at epoch 2 | loss : 1.14/1.04 | micro_F1 : 0.24/0.22:   0%|          | 1/300 [00:12<33:00,  6.62s/it]train/val metrics at epoch 2 | loss : 1.14/1.04 | micro_F1 : 0.24/0.22:   1%|          | 2/300 [00:12<31:59,  6.44s/it]train/val metrics at epoch 3 | loss : 1.12/1.03 | micro_F1 : 0.27/0.24:   1%|          | 2/300 [00:19<31:59,  6.44s/it]train/val metrics at epoch 3 | loss : 1.12/1.03 | micro_F1 : 0.27/0.24:   1%|          | 3/300 [00:19<31:44,  6.41s/it]train/val metrics at epoch 4 | loss : 1.10/1.02 | micro_F1 : 0.28/0.26:   1%|          | 3/300 [00:25<31:44,  6.41s/it]train/val metrics at epoch 4 | loss : 1.10/1.02 | micro_F1 : 0.28/0.26:   1%|▏         | 4/300 [00:25<31:46,  6.44s/it]train/val metrics at epoch 5 | loss : 1.09/1.02 | micro_F1 : 0.30/0.27:   1%|▏         | 4/300 [00:31<31:46,  6.44s/it]train/val metrics at epoch 5 | loss : 1.09/1.02 | micro_F1 : 0.30/0.27:   2%|▏         | 5/300 [00:31<31:11,  6.34s/it]train/val metrics at epoch 6 | loss : 1.07/1.01 | micro_F1 : 0.31/0.30:   2%|▏         | 5/300 [00:37<31:11,  6.34s/it]train/val metrics at epoch 6 | loss : 1.07/1.01 | micro_F1 : 0.31/0.30:   2%|▏         | 6/300 [00:38<30:52,  6.30s/it]train/val metrics at epoch 7 | loss : 1.06/0.99 | micro_F1 : 0.32/0.30:   2%|▏         | 6/300 [00:44<30:52,  6.30s/it]train/val metrics at epoch 7 | loss : 1.06/0.99 | micro_F1 : 0.32/0.30:   2%|▏         | 7/300 [00:44<30:53,  6.33s/it]train/val metrics at epoch 8 | loss : 1.04/0.99 | micro_F1 : 0.33/0.32:   2%|▏         | 7/300 [00:50<30:53,  6.33s/it]train/val metrics at epoch 8 | loss : 1.04/0.99 | micro_F1 : 0.33/0.32:   3%|▎         | 8/300 [00:50<30:38,  6.30s/it]train/val metrics at epoch 9 | loss : 1.02/0.96 | micro_F1 : 0.34/0.31:   3%|▎         | 8/300 [00:56<30:38,  6.30s/it]train/val metrics at epoch 9 | loss : 1.02/0.96 | micro_F1 : 0.34/0.31:   3%|▎         | 9/300 [00:57<30:26,  6.28s/it]train/val metrics at epoch 10 | loss : 1.01/0.96 | micro_F1 : 0.35/0.31:   3%|▎         | 9/300 [01:03<30:26,  6.28s/it]train/val metrics at epoch 10 | loss : 1.01/0.96 | micro_F1 : 0.35/0.31:   3%|▎         | 10/300 [01:03<30:24,  6.29s/it]train/val metrics at epoch 11 | loss : 1.00/0.95 | micro_F1 : 0.35/0.32:   3%|▎         | 10/300 [01:09<30:24,  6.29s/it]train/val metrics at epoch 11 | loss : 1.00/0.95 | micro_F1 : 0.35/0.32:   4%|▎         | 11/300 [01:09<30:25,  6.32s/it]train/val metrics at epoch 12 | loss : 0.99/0.95 | micro_F1 : 0.36/0.32:   4%|▎         | 11/300 [01:15<30:25,  6.32s/it]train/val metrics at epoch 12 | loss : 0.99/0.95 | micro_F1 : 0.36/0.32:   4%|▍         | 12/300 [01:15<30:11,  6.29s/it]train/val metrics at epoch 13 | loss : 0.98/0.94 | micro_F1 : 0.36/0.32:   4%|▍         | 12/300 [01:21<30:11,  6.29s/it]train/val metrics at epoch 13 | loss : 0.98/0.94 | micro_F1 : 0.36/0.32:   4%|▍         | 13/300 [01:22<29:54,  6.25s/it]train/val metrics at epoch 14 | loss : 0.96/0.94 | micro_F1 : 0.36/0.31:   4%|▍         | 13/300 [01:28<29:54,  6.25s/it]train/val metrics at epoch 14 | loss : 0.96/0.94 | micro_F1 : 0.36/0.31:   5%|▍         | 14/300 [01:28<29:46,  6.25s/it]train/val metrics at epoch 15 | loss : 0.96/0.93 | micro_F1 : 0.37/0.32:   5%|▍         | 14/300 [01:34<29:46,  6.25s/it]train/val metrics at epoch 15 | loss : 0.96/0.93 | micro_F1 : 0.37/0.32:   5%|▌         | 15/300 [01:34<29:41,  6.25s/it]train/val metrics at epoch 16 | loss : 0.95/0.94 | micro_F1 : 0.37/0.32:   5%|▌         | 15/300 [01:40<29:41,  6.25s/it]train/val metrics at epoch 16 | loss : 0.95/0.94 | micro_F1 : 0.37/0.32:   5%|▌         | 16/300 [01:40<29:33,  6.25s/it]train/val metrics at epoch 17 | loss : 0.94/0.93 | micro_F1 : 0.37/0.33:   5%|▌         | 16/300 [01:46<29:33,  6.25s/it]train/val metrics at epoch 17 | loss : 0.94/0.93 | micro_F1 : 0.37/0.33:   6%|▌         | 17/300 [01:47<29:30,  6.26s/it]train/val metrics at epoch 18 | loss : 0.93/0.93 | micro_F1 : 0.37/0.33:   6%|▌         | 17/300 [01:53<29:30,  6.26s/it]train/val metrics at epoch 18 | loss : 0.93/0.93 | micro_F1 : 0.37/0.33:   6%|▌         | 18/300 [01:53<29:35,  6.30s/it]train/val metrics at epoch 19 | loss : 0.92/0.92 | micro_F1 : 0.37/0.33:   6%|▌         | 18/300 [01:59<29:35,  6.30s/it]train/val metrics at epoch 19 | loss : 0.92/0.92 | micro_F1 : 0.37/0.33:   6%|▋         | 19/300 [01:59<29:21,  6.27s/it]train/val metrics at epoch 20 | loss : 0.91/0.92 | micro_F1 : 0.38/0.34:   6%|▋         | 19/300 [02:05<29:21,  6.27s/it]train/val metrics at epoch 20 | loss : 0.91/0.92 | micro_F1 : 0.38/0.34:   7%|▋         | 20/300 [02:05<29:01,  6.22s/it]train/val metrics at epoch 21 | loss : 0.91/0.92 | micro_F1 : 0.38/0.35:   7%|▋         | 20/300 [02:11<29:01,  6.22s/it]train/val metrics at epoch 21 | loss : 0.91/0.92 | micro_F1 : 0.38/0.35:   7%|▋         | 21/300 [02:12<29:02,  6.25s/it]train/val metrics at epoch 22 | loss : 0.90/0.91 | micro_F1 : 0.38/0.35:   7%|▋         | 21/300 [02:18<29:02,  6.25s/it]train/val metrics at epoch 22 | loss : 0.90/0.91 | micro_F1 : 0.38/0.35:   7%|▋         | 22/300 [02:18<28:52,  6.23s/it]train/val metrics at epoch 23 | loss : 0.89/0.92 | micro_F1 : 0.39/0.34:   7%|▋         | 22/300 [02:24<28:52,  6.23s/it]train/val metrics at epoch 23 | loss : 0.89/0.92 | micro_F1 : 0.39/0.34:   8%|▊         | 23/300 [02:24<29:02,  6.29s/it]train/val metrics at epoch 24 | loss : 0.88/0.91 | micro_F1 : 0.39/0.34:   8%|▊         | 23/300 [02:30<29:02,  6.29s/it]train/val metrics at epoch 24 | loss : 0.88/0.91 | micro_F1 : 0.39/0.34:   8%|▊         | 24/300 [02:31<28:59,  6.30s/it]train/val metrics at epoch 25 | loss : 0.87/0.91 | micro_F1 : 0.40/0.33:   8%|▊         | 24/300 [02:37<28:59,  6.30s/it]train/val metrics at epoch 25 | loss : 0.87/0.91 | micro_F1 : 0.40/0.33:   8%|▊         | 25/300 [02:37<28:44,  6.27s/it]train/val metrics at epoch 26 | loss : 0.87/0.92 | micro_F1 : 0.39/0.34:   8%|▊         | 25/300 [02:43<28:44,  6.27s/it]train/val metrics at epoch 26 | loss : 0.87/0.92 | micro_F1 : 0.39/0.34:   9%|▊         | 26/300 [02:43<28:46,  6.30s/it]train/val metrics at epoch 27 | loss : 0.87/0.92 | micro_F1 : 0.40/0.34:   9%|▊         | 26/300 [02:49<28:46,  6.30s/it]train/val metrics at epoch 27 | loss : 0.87/0.92 | micro_F1 : 0.40/0.34:   9%|▉         | 27/300 [02:49<28:39,  6.30s/it]train/val metrics at epoch 28 | loss : 0.87/0.92 | micro_F1 : 0.40/0.34:   9%|▉         | 27/300 [02:55<28:39,  6.30s/it]train/val metrics at epoch 28 | loss : 0.87/0.92 | micro_F1 : 0.40/0.34:   9%|▉         | 28/300 [02:56<28:20,  6.25s/it]train/val metrics at epoch 29 | loss : 0.87/0.92 | micro_F1 : 0.40/0.34:   9%|▉         | 28/300 [03:02<28:20,  6.25s/it]train/val metrics at epoch 29 | loss : 0.87/0.92 | micro_F1 : 0.40/0.34:  10%|▉         | 29/300 [03:02<28:11,  6.24s/it]train/val metrics at epoch 30 | loss : 0.86/0.92 | micro_F1 : 0.40/0.35:  10%|▉         | 29/300 [03:08<28:11,  6.24s/it]train/val metrics at epoch 30 | loss : 0.86/0.92 | micro_F1 : 0.40/0.35:  10%|█         | 30/300 [03:08<28:13,  6.27s/it]train/val metrics at epoch 31 | loss : 0.86/0.92 | micro_F1 : 0.40/0.34:  10%|█         | 30/300 [03:14<28:13,  6.27s/it]train/val metrics at epoch 31 | loss : 0.86/0.92 | micro_F1 : 0.40/0.34:  10%|█         | 31/300 [03:14<28:05,  6.27s/it]train/val metrics at epoch 32 | loss : 0.86/0.92 | micro_F1 : 0.40/0.34:  10%|█         | 31/300 [03:20<28:05,  6.27s/it]train/val metrics at epoch 32 | loss : 0.86/0.92 | micro_F1 : 0.40/0.34:  10%|█         | 31/300 [03:21<29:05,  6.49s/it]
wandb: Currently logged in as: tha-santacruz (msc-nicola). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/santacro/masters_thesis/fusion_tuning/wandb/run-20230626_160028-a77npm1e
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dazzling-armadillo-18
wandb: ⭐️ View project at https://wandb.ai/msc-nicola/test_fusion_tuning
wandb: 🚀 View run at https://wandb.ai/msc-nicola/test_fusion_tuning/runs/a77npm1e
Running job on GPU : Tesla V100-PCIE-32GB
Namespace(BATCH_SIZE=128, CHECKPOINTS_PATH='/scratch/izar/santacro/checkpoints/', DATASET_PATH='/scratch/izar/santacro/final_data/', DEVICE='cuda:0', EMBEDDING='longformer', EPOCH_NUM=300, FRACTION=40, FUSION='max', HIDDEN_SIZE=8192, LEARNING_RATE=1e-05, LEVEL='L1', LOAD_CHECKPOINT='yes', MERGE_METHOD='fusion', MIN_LEARNING_RATE=1e-06, NORMALIZE='yes', NUM_WORKERS=8, RANDOM_STATE=1, RUN_MODE='test', SAVE_CHECKPOINTS='yes', SPLITTING='species', TARGET_BASE='set', WANDB_ENTITY='msc-nicola', WANDB_LOGS='yes', WANDB_PROJECT='fusion_tuning')
Loaded model state dict from file /scratch/izar/santacro/checkpoints/temp.pth
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:     test loss ▁
wandb: test macro F1 ▁
wandb:  test macro H ▁
wandb: test micro F1 ▁
wandb: 
wandb: Run summary:
wandb:     test loss 1.14141
wandb: test macro F1 0.27056
wandb:  test macro H 2.34621
wandb: test micro F1 0.34055
wandb: 
wandb: 🚀 View run dazzling-armadillo-18 at: https://wandb.ai/msc-nicola/test_fusion_tuning/runs/a77npm1e
wandb: Synced 4 W&B file(s), 10 media file(s), 1 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230626_160028-a77npm1e/logs
