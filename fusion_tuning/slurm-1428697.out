/usr/share/lmod/lmod/init/sh: line 20: /usr/share/lmod/lmod/libexec//clearMT_cmd: No such file or directory
wandb: Currently logged in as: tha-santacruz (msc-nicola). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/santacro/masters_thesis/fusion_tuning/wandb/run-20230626_165353-qk6221os
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run good-salad-9
wandb: ‚≠êÔ∏è View project at https://wandb.ai/msc-nicola/train_fusion_tuning
wandb: üöÄ View run at https://wandb.ai/msc-nicola/train_fusion_tuning/runs/qk6221os
Running job on GPU : Tesla V100-PCIE-32GB
Namespace(BATCH_SIZE=128, CHECKPOINTS_PATH='/scratch/izar/santacro/checkpoints/', DATASET_PATH='/scratch/izar/santacro/final_data/', DEVICE='cuda:0', EMBEDDING='longformer', EPOCH_NUM=300, FRACTION=40, FUSION='sum', HIDDEN_SIZE=8192, LEARNING_RATE=1e-05, LEVEL='L1', LOAD_CHECKPOINT='no', MERGE_METHOD='fusion', MIN_LEARNING_RATE=1e-06, NORMALIZE='no', NUM_WORKERS=8, RANDOM_STATE=1, RUN_MODE='train', SAVE_CHECKPOINTS='yes', SPLITTING='species', TARGET_BASE='set', WANDB_ENTITY='msc-nicola', WANDB_LOGS='yes', WANDB_PROJECT='fusion_tuning')
  0%|          | 0/300 [00:00<?, ?it/s]train/val metrics at epoch 1 | loss : 1.16/1.06 | micro_F1 : 0.23/0.21:   0%|          | 0/300 [00:11<?, ?it/s]train/val metrics at epoch 1 | loss : 1.16/1.06 | micro_F1 : 0.23/0.21:   0%|          | 1/300 [00:11<57:39, 11.57s/it]train/val metrics at epoch 2 | loss : 1.14/1.05 | micro_F1 : 0.25/0.19:   0%|          | 1/300 [00:17<57:39, 11.57s/it]train/val metrics at epoch 2 | loss : 1.14/1.05 | micro_F1 : 0.25/0.19:   1%|          | 2/300 [00:17<41:32,  8.36s/it]train/val metrics at epoch 3 | loss : 1.13/1.04 | micro_F1 : 0.26/0.21:   1%|          | 2/300 [00:23<41:32,  8.36s/it]train/val metrics at epoch 3 | loss : 1.13/1.04 | micro_F1 : 0.26/0.21:   1%|          | 3/300 [00:23<36:28,  7.37s/it]train/val metrics at epoch 4 | loss : 1.11/1.04 | micro_F1 : 0.28/0.24:   1%|          | 3/300 [00:29<36:28,  7.37s/it]train/val metrics at epoch 4 | loss : 1.11/1.04 | micro_F1 : 0.28/0.24:   1%|‚ñè         | 4/300 [00:30<34:06,  6.91s/it]train/val metrics at epoch 5 | loss : 1.10/1.03 | micro_F1 : 0.29/0.27:   1%|‚ñè         | 4/300 [00:36<34:06,  6.91s/it]train/val metrics at epoch 5 | loss : 1.10/1.03 | micro_F1 : 0.29/0.27:   2%|‚ñè         | 5/300 [00:36<33:04,  6.73s/it]train/val metrics at epoch 6 | loss : 1.09/1.06 | micro_F1 : 0.31/0.24:   2%|‚ñè         | 5/300 [00:42<33:04,  6.73s/it]train/val metrics at epoch 6 | loss : 1.09/1.06 | micro_F1 : 0.31/0.24:   2%|‚ñè         | 6/300 [00:43<32:36,  6.66s/it]train/val metrics at epoch 7 | loss : 1.09/1.03 | micro_F1 : 0.30/0.27:   2%|‚ñè         | 6/300 [00:48<32:36,  6.66s/it]train/val metrics at epoch 7 | loss : 1.09/1.03 | micro_F1 : 0.30/0.27:   2%|‚ñè         | 7/300 [00:49<31:42,  6.49s/it]train/val metrics at epoch 8 | loss : 1.08/1.03 | micro_F1 : 0.31/0.28:   2%|‚ñè         | 7/300 [00:55<31:42,  6.49s/it]train/val metrics at epoch 8 | loss : 1.08/1.03 | micro_F1 : 0.31/0.28:   3%|‚ñé         | 8/300 [00:55<31:03,  6.38s/it]train/val metrics at epoch 9 | loss : 1.07/1.01 | micro_F1 : 0.32/0.23:   3%|‚ñé         | 8/300 [01:01<31:03,  6.38s/it]train/val metrics at epoch 9 | loss : 1.07/1.01 | micro_F1 : 0.32/0.23:   3%|‚ñé         | 9/300 [01:01<30:33,  6.30s/it]train/val metrics at epoch 10 | loss : 1.06/1.02 | micro_F1 : 0.32/0.24:   3%|‚ñé         | 9/300 [01:07<30:33,  6.30s/it]train/val metrics at epoch 10 | loss : 1.06/1.02 | micro_F1 : 0.32/0.24:   3%|‚ñé         | 10/300 [01:07<30:31,  6.32s/it]train/val metrics at epoch 11 | loss : 1.06/1.00 | micro_F1 : 0.32/0.32:   3%|‚ñé         | 10/300 [01:13<30:31,  6.32s/it]train/val metrics at epoch 11 | loss : 1.06/1.00 | micro_F1 : 0.32/0.32:   4%|‚ñé         | 11/300 [01:13<30:09,  6.26s/it]train/val metrics at epoch 12 | loss : 1.06/1.00 | micro_F1 : 0.33/0.32:   4%|‚ñé         | 11/300 [01:20<30:09,  6.26s/it]train/val metrics at epoch 12 | loss : 1.06/1.00 | micro_F1 : 0.33/0.32:   4%|‚ñç         | 12/300 [01:20<30:11,  6.29s/it]train/val metrics at epoch 13 | loss : 1.05/1.02 | micro_F1 : 0.33/0.20:   4%|‚ñç         | 12/300 [01:26<30:11,  6.29s/it]train/val metrics at epoch 13 | loss : 1.05/1.02 | micro_F1 : 0.33/0.20:   4%|‚ñç         | 13/300 [01:26<30:03,  6.28s/it]train/val metrics at epoch 14 | loss : 1.05/1.00 | micro_F1 : 0.33/0.29:   4%|‚ñç         | 13/300 [01:32<30:03,  6.28s/it]train/val metrics at epoch 14 | loss : 1.05/1.00 | micro_F1 : 0.33/0.29:   5%|‚ñç         | 14/300 [01:32<30:01,  6.30s/it]train/val metrics at epoch 15 | loss : 1.04/1.01 | micro_F1 : 0.34/0.37:   5%|‚ñç         | 14/300 [01:38<30:01,  6.30s/it]train/val metrics at epoch 15 | loss : 1.04/1.01 | micro_F1 : 0.34/0.37:   5%|‚ñå         | 15/300 [01:39<29:51,  6.28s/it]train/val metrics at epoch 16 | loss : 1.03/0.99 | micro_F1 : 0.34/0.28:   5%|‚ñå         | 15/300 [01:45<29:51,  6.28s/it]train/val metrics at epoch 16 | loss : 1.03/0.99 | micro_F1 : 0.34/0.28:   5%|‚ñå         | 16/300 [01:45<29:53,  6.32s/it]train/val metrics at epoch 17 | loss : 1.03/0.99 | micro_F1 : 0.34/0.24:   5%|‚ñå         | 16/300 [01:51<29:53,  6.32s/it]train/val metrics at epoch 17 | loss : 1.03/0.99 | micro_F1 : 0.34/0.24:   6%|‚ñå         | 17/300 [01:51<29:32,  6.26s/it]train/val metrics at epoch 18 | loss : 1.02/0.99 | micro_F1 : 0.34/0.29:   6%|‚ñå         | 17/300 [01:57<29:32,  6.26s/it]train/val metrics at epoch 18 | loss : 1.02/0.99 | micro_F1 : 0.34/0.29:   6%|‚ñå         | 18/300 [01:57<29:20,  6.24s/it]train/val metrics at epoch 19 | loss : 1.02/0.97 | micro_F1 : 0.35/0.28:   6%|‚ñå         | 18/300 [02:04<29:20,  6.24s/it]train/val metrics at epoch 19 | loss : 1.02/0.97 | micro_F1 : 0.35/0.28:   6%|‚ñã         | 19/300 [02:04<29:24,  6.28s/it]train/val metrics at epoch 20 | loss : 1.01/0.97 | micro_F1 : 0.35/0.32:   6%|‚ñã         | 19/300 [02:10<29:24,  6.28s/it]train/val metrics at epoch 20 | loss : 1.01/0.97 | micro_F1 : 0.35/0.32:   7%|‚ñã         | 20/300 [02:10<29:01,  6.22s/it]train/val metrics at epoch 21 | loss : 1.02/0.98 | micro_F1 : 0.35/0.25:   7%|‚ñã         | 20/300 [02:16<29:01,  6.22s/it]train/val metrics at epoch 21 | loss : 1.02/0.98 | micro_F1 : 0.35/0.25:   7%|‚ñã         | 21/300 [02:16<29:01,  6.24s/it]train/val metrics at epoch 22 | loss : 1.01/0.96 | micro_F1 : 0.35/0.28:   7%|‚ñã         | 21/300 [02:22<29:01,  6.24s/it]train/val metrics at epoch 22 | loss : 1.01/0.96 | micro_F1 : 0.35/0.28:   7%|‚ñã         | 22/300 [02:22<28:52,  6.23s/it]train/val metrics at epoch 23 | loss : 1.01/0.99 | micro_F1 : 0.35/0.22:   7%|‚ñã         | 22/300 [02:28<28:52,  6.23s/it]train/val metrics at epoch 23 | loss : 1.01/0.99 | micro_F1 : 0.35/0.22:   8%|‚ñä         | 23/300 [02:28<28:36,  6.20s/it]train/val metrics at epoch 24 | loss : 1.00/0.96 | micro_F1 : 0.35/0.34:   8%|‚ñä         | 23/300 [02:35<28:36,  6.20s/it]train/val metrics at epoch 24 | loss : 1.00/0.96 | micro_F1 : 0.35/0.34:   8%|‚ñä         | 24/300 [02:35<28:39,  6.23s/it]train/val metrics at epoch 25 | loss : 1.00/0.98 | micro_F1 : 0.35/0.22:   8%|‚ñä         | 24/300 [02:41<28:39,  6.23s/it]train/val metrics at epoch 25 | loss : 1.00/0.98 | micro_F1 : 0.35/0.22:   8%|‚ñä         | 25/300 [02:41<28:45,  6.28s/it]train/val metrics at epoch 26 | loss : 1.00/0.95 | micro_F1 : 0.35/0.31:   8%|‚ñä         | 25/300 [02:47<28:45,  6.28s/it]train/val metrics at epoch 26 | loss : 1.00/0.95 | micro_F1 : 0.35/0.31:   9%|‚ñä         | 26/300 [02:47<28:46,  6.30s/it]train/val metrics at epoch 27 | loss : 0.99/0.95 | micro_F1 : 0.36/0.30:   9%|‚ñä         | 26/300 [02:54<28:46,  6.30s/it]train/val metrics at epoch 27 | loss : 0.99/0.95 | micro_F1 : 0.36/0.30:   9%|‚ñâ         | 27/300 [02:54<28:36,  6.29s/it]train/val metrics at epoch 28 | loss : 0.99/0.95 | micro_F1 : 0.36/0.32:   9%|‚ñâ         | 27/300 [03:00<28:36,  6.29s/it]train/val metrics at epoch 28 | loss : 0.99/0.95 | micro_F1 : 0.36/0.32:   9%|‚ñâ         | 28/300 [03:00<28:24,  6.27s/it]train/val metrics at epoch 29 | loss : 0.99/0.96 | micro_F1 : 0.36/0.26:   9%|‚ñâ         | 28/300 [03:06<28:24,  6.27s/it]train/val metrics at epoch 29 | loss : 0.99/0.96 | micro_F1 : 0.36/0.26:  10%|‚ñâ         | 29/300 [03:06<28:21,  6.28s/it]train/val metrics at epoch 30 | loss : 0.99/0.95 | micro_F1 : 0.36/0.30:  10%|‚ñâ         | 29/300 [03:12<28:21,  6.28s/it]train/val metrics at epoch 30 | loss : 0.99/0.95 | micro_F1 : 0.36/0.30:  10%|‚ñà         | 30/300 [03:13<28:21,  6.30s/it]train/val metrics at epoch 31 | loss : 0.98/0.94 | micro_F1 : 0.36/0.34:  10%|‚ñà         | 30/300 [03:19<28:21,  6.30s/it]train/val metrics at epoch 31 | loss : 0.98/0.94 | micro_F1 : 0.36/0.34:  10%|‚ñà         | 31/300 [03:19<28:12,  6.29s/it]train/val metrics at epoch 32 | loss : 0.98/0.95 | micro_F1 : 0.36/0.29:  10%|‚ñà         | 31/300 [03:25<28:12,  6.29s/it]train/val metrics at epoch 32 | loss : 0.98/0.95 | micro_F1 : 0.36/0.29:  11%|‚ñà         | 32/300 [03:25<28:13,  6.32s/it]train/val metrics at epoch 33 | loss : 0.98/0.94 | micro_F1 : 0.36/0.34:  11%|‚ñà         | 32/300 [03:32<28:13,  6.32s/it]train/val metrics at epoch 33 | loss : 0.98/0.94 | micro_F1 : 0.36/0.34:  11%|‚ñà         | 33/300 [03:32<28:18,  6.36s/it]train/val metrics at epoch 34 | loss : 0.98/0.95 | micro_F1 : 0.36/0.29:  11%|‚ñà         | 33/300 [03:38<28:18,  6.36s/it]train/val metrics at epoch 34 | loss : 0.98/0.95 | micro_F1 : 0.36/0.29:  11%|‚ñà‚ñè        | 34/300 [03:38<28:18,  6.38s/it]train/val metrics at epoch 35 | loss : 0.98/0.94 | micro_F1 : 0.36/0.34:  11%|‚ñà‚ñè        | 34/300 [03:44<28:18,  6.38s/it]train/val metrics at epoch 35 | loss : 0.98/0.94 | micro_F1 : 0.36/0.34:  12%|‚ñà‚ñè        | 35/300 [03:45<28:11,  6.38s/it]train/val metrics at epoch 36 | loss : 0.98/0.95 | micro_F1 : 0.36/0.30:  12%|‚ñà‚ñè        | 35/300 [03:51<28:11,  6.38s/it]train/val metrics at epoch 36 | loss : 0.98/0.95 | micro_F1 : 0.36/0.30:  12%|‚ñà‚ñè        | 36/300 [03:51<27:57,  6.35s/it]train/val metrics at epoch 37 | loss : 0.98/0.94 | micro_F1 : 0.36/0.32:  12%|‚ñà‚ñè        | 36/300 [03:57<27:57,  6.35s/it]train/val metrics at epoch 37 | loss : 0.98/0.94 | micro_F1 : 0.36/0.32:  12%|‚ñà‚ñè        | 37/300 [03:57<27:39,  6.31s/it]train/val metrics at epoch 38 | loss : 0.97/0.94 | micro_F1 : 0.36/0.32:  12%|‚ñà‚ñè        | 37/300 [04:03<27:39,  6.31s/it]train/val metrics at epoch 38 | loss : 0.97/0.94 | micro_F1 : 0.36/0.32:  13%|‚ñà‚ñé        | 38/300 [04:03<27:38,  6.33s/it]train/val metrics at epoch 39 | loss : 0.97/0.94 | micro_F1 : 0.36/0.29:  13%|‚ñà‚ñé        | 38/300 [04:10<27:38,  6.33s/it]train/val metrics at epoch 39 | loss : 0.97/0.94 | micro_F1 : 0.36/0.29:  13%|‚ñà‚ñé        | 39/300 [04:10<27:29,  6.32s/it]train/val metrics at epoch 40 | loss : 0.97/0.94 | micro_F1 : 0.36/0.29:  13%|‚ñà‚ñé        | 39/300 [04:16<27:29,  6.32s/it]train/val metrics at epoch 40 | loss : 0.97/0.94 | micro_F1 : 0.36/0.29:  13%|‚ñà‚ñé        | 40/300 [04:16<27:20,  6.31s/it]train/val metrics at epoch 41 | loss : 0.97/0.95 | micro_F1 : 0.36/0.31:  13%|‚ñà‚ñé        | 40/300 [04:22<27:20,  6.31s/it]train/val metrics at epoch 41 | loss : 0.97/0.95 | micro_F1 : 0.36/0.31:  14%|‚ñà‚ñé        | 41/300 [04:22<27:07,  6.28s/it]train/val metrics at epoch 42 | loss : 0.97/0.95 | micro_F1 : 0.36/0.30:  14%|‚ñà‚ñé        | 41/300 [04:28<27:07,  6.28s/it]train/val metrics at epoch 42 | loss : 0.97/0.95 | micro_F1 : 0.36/0.30:  14%|‚ñà‚ñç        | 42/300 [04:28<26:46,  6.23s/it]train/val metrics at epoch 43 | loss : 0.97/0.95 | micro_F1 : 0.36/0.32:  14%|‚ñà‚ñç        | 42/300 [04:34<26:46,  6.23s/it]train/val metrics at epoch 43 | loss : 0.97/0.95 | micro_F1 : 0.36/0.32:  14%|‚ñà‚ñç        | 43/300 [04:34<26:34,  6.21s/it]train/val metrics at epoch 44 | loss : 0.97/0.94 | micro_F1 : 0.36/0.30:  14%|‚ñà‚ñç        | 43/300 [04:40<26:34,  6.21s/it]train/val metrics at epoch 44 | loss : 0.97/0.94 | micro_F1 : 0.36/0.30:  15%|‚ñà‚ñç        | 44/300 [04:41<26:18,  6.17s/it]train/val metrics at epoch 45 | loss : 0.97/0.95 | micro_F1 : 0.37/0.30:  15%|‚ñà‚ñç        | 44/300 [04:47<26:18,  6.17s/it]train/val metrics at epoch 45 | loss : 0.97/0.95 | micro_F1 : 0.37/0.30:  15%|‚ñà‚ñå        | 45/300 [04:47<26:18,  6.19s/it]train/val metrics at epoch 46 | loss : 0.97/0.93 | micro_F1 : 0.36/0.28:  15%|‚ñà‚ñå        | 45/300 [04:53<26:18,  6.19s/it]train/val metrics at epoch 46 | loss : 0.97/0.93 | micro_F1 : 0.36/0.28:  15%|‚ñà‚ñå        | 46/300 [04:53<26:11,  6.19s/it]train/val metrics at epoch 47 | loss : 0.97/0.94 | micro_F1 : 0.36/0.32:  15%|‚ñà‚ñå        | 46/300 [04:59<26:11,  6.19s/it]train/val metrics at epoch 47 | loss : 0.97/0.94 | micro_F1 : 0.36/0.32:  16%|‚ñà‚ñå        | 47/300 [04:59<26:17,  6.24s/it]train/val metrics at epoch 48 | loss : 0.97/0.95 | micro_F1 : 0.37/0.30:  16%|‚ñà‚ñå        | 47/300 [05:05<26:17,  6.24s/it]train/val metrics at epoch 48 | loss : 0.97/0.95 | micro_F1 : 0.37/0.30:  16%|‚ñà‚ñå        | 48/300 [05:06<26:12,  6.24s/it]train/val metrics at epoch 49 | loss : 0.97/0.94 | micro_F1 : 0.37/0.33:  16%|‚ñà‚ñå        | 48/300 [05:12<26:12,  6.24s/it]train/val metrics at epoch 49 | loss : 0.97/0.94 | micro_F1 : 0.37/0.33:  16%|‚ñà‚ñã        | 49/300 [05:12<26:18,  6.29s/it]train/val metrics at epoch 50 | loss : 0.96/0.94 | micro_F1 : 0.37/0.27:  16%|‚ñà‚ñã        | 49/300 [05:18<26:18,  6.29s/it]train/val metrics at epoch 50 | loss : 0.96/0.94 | micro_F1 : 0.37/0.27:  17%|‚ñà‚ñã        | 50/300 [05:18<26:03,  6.26s/it]train/val metrics at epoch 51 | loss : 0.96/0.95 | micro_F1 : 0.36/0.31:  17%|‚ñà‚ñã        | 50/300 [05:24<26:03,  6.26s/it]train/val metrics at epoch 51 | loss : 0.96/0.95 | micro_F1 : 0.36/0.31:  17%|‚ñà‚ñã        | 51/300 [05:24<26:03,  6.28s/it]train/val metrics at epoch 52 | loss : 0.96/0.94 | micro_F1 : 0.37/0.31:  17%|‚ñà‚ñã        | 51/300 [05:30<26:03,  6.28s/it]train/val metrics at epoch 52 | loss : 0.96/0.94 | micro_F1 : 0.37/0.31:  17%|‚ñà‚ñã        | 52/300 [05:31<25:49,  6.25s/it]train/val metrics at epoch 53 | loss : 0.96/0.93 | micro_F1 : 0.37/0.31:  17%|‚ñà‚ñã        | 52/300 [05:37<25:49,  6.25s/it]train/val metrics at epoch 53 | loss : 0.96/0.93 | micro_F1 : 0.37/0.31:  18%|‚ñà‚ñä        | 53/300 [05:37<25:36,  6.22s/it]train/val metrics at epoch 54 | loss : 0.96/0.93 | micro_F1 : 0.36/0.31:  18%|‚ñà‚ñä        | 53/300 [05:43<25:36,  6.22s/it]train/val metrics at epoch 54 | loss : 0.96/0.93 | micro_F1 : 0.36/0.31:  18%|‚ñà‚ñä        | 54/300 [05:43<25:37,  6.25s/it]train/val metrics at epoch 55 | loss : 0.96/0.94 | micro_F1 : 0.37/0.31:  18%|‚ñà‚ñä        | 54/300 [05:49<25:37,  6.25s/it]train/val metrics at epoch 55 | loss : 0.96/0.94 | micro_F1 : 0.37/0.31:  18%|‚ñà‚ñä        | 55/300 [05:49<25:28,  6.24s/it]train/val metrics at epoch 56 | loss : 0.96/0.94 | micro_F1 : 0.36/0.30:  18%|‚ñà‚ñä        | 55/300 [05:56<25:28,  6.24s/it]train/val metrics at epoch 56 | loss : 0.96/0.94 | micro_F1 : 0.36/0.30:  19%|‚ñà‚ñä        | 56/300 [05:56<25:31,  6.28s/it]train/val metrics at epoch 57 | loss : 0.96/0.93 | micro_F1 : 0.37/0.32:  19%|‚ñà‚ñä        | 56/300 [06:02<25:31,  6.28s/it]train/val metrics at epoch 57 | loss : 0.96/0.93 | micro_F1 : 0.37/0.32:  19%|‚ñà‚ñâ        | 57/300 [06:02<25:22,  6.27s/it]train/val metrics at epoch 58 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  19%|‚ñà‚ñâ        | 57/300 [06:08<25:22,  6.27s/it]train/val metrics at epoch 58 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  19%|‚ñà‚ñâ        | 58/300 [06:08<25:05,  6.22s/it]train/val metrics at epoch 59 | loss : 0.96/0.93 | micro_F1 : 0.37/0.32:  19%|‚ñà‚ñâ        | 58/300 [06:14<25:05,  6.22s/it]train/val metrics at epoch 59 | loss : 0.96/0.93 | micro_F1 : 0.37/0.32:  20%|‚ñà‚ñâ        | 59/300 [06:14<24:56,  6.21s/it]train/val metrics at epoch 60 | loss : 0.96/0.93 | micro_F1 : 0.37/0.33:  20%|‚ñà‚ñâ        | 59/300 [06:20<24:56,  6.21s/it]train/val metrics at epoch 60 | loss : 0.96/0.93 | micro_F1 : 0.37/0.33:  20%|‚ñà‚ñà        | 60/300 [06:21<24:59,  6.25s/it]train/val metrics at epoch 61 | loss : 0.96/0.93 | micro_F1 : 0.36/0.30:  20%|‚ñà‚ñà        | 60/300 [06:27<24:59,  6.25s/it]train/val metrics at epoch 61 | loss : 0.96/0.93 | micro_F1 : 0.36/0.30:  20%|‚ñà‚ñà        | 61/300 [06:27<24:46,  6.22s/it]train/val metrics at epoch 62 | loss : 0.95/0.94 | micro_F1 : 0.37/0.29:  20%|‚ñà‚ñà        | 61/300 [06:33<24:46,  6.22s/it]train/val metrics at epoch 62 | loss : 0.95/0.94 | micro_F1 : 0.37/0.29:  21%|‚ñà‚ñà        | 62/300 [06:33<24:33,  6.19s/it]train/val metrics at epoch 63 | loss : 0.95/0.93 | micro_F1 : 0.37/0.33:  21%|‚ñà‚ñà        | 62/300 [06:39<24:33,  6.19s/it]train/val metrics at epoch 63 | loss : 0.95/0.93 | micro_F1 : 0.37/0.33:  21%|‚ñà‚ñà        | 63/300 [06:39<24:28,  6.20s/it]train/val metrics at epoch 64 | loss : 0.96/0.93 | micro_F1 : 0.37/0.31:  21%|‚ñà‚ñà        | 63/300 [06:45<24:28,  6.20s/it]train/val metrics at epoch 64 | loss : 0.96/0.93 | micro_F1 : 0.37/0.31:  21%|‚ñà‚ñà‚ñè       | 64/300 [06:45<24:28,  6.22s/it]train/val metrics at epoch 65 | loss : 0.96/0.94 | micro_F1 : 0.36/0.30:  21%|‚ñà‚ñà‚ñè       | 64/300 [06:51<24:28,  6.22s/it]train/val metrics at epoch 65 | loss : 0.96/0.94 | micro_F1 : 0.36/0.30:  22%|‚ñà‚ñà‚ñè       | 65/300 [06:52<24:26,  6.24s/it]train/val metrics at epoch 66 | loss : 0.95/0.92 | micro_F1 : 0.37/0.32:  22%|‚ñà‚ñà‚ñè       | 65/300 [06:58<24:26,  6.24s/it]train/val metrics at epoch 66 | loss : 0.95/0.92 | micro_F1 : 0.37/0.32:  22%|‚ñà‚ñà‚ñè       | 66/300 [06:58<24:33,  6.30s/it]train/val metrics at epoch 67 | loss : 0.95/0.94 | micro_F1 : 0.37/0.32:  22%|‚ñà‚ñà‚ñè       | 66/300 [07:04<24:33,  6.30s/it]train/val metrics at epoch 67 | loss : 0.95/0.94 | micro_F1 : 0.37/0.32:  22%|‚ñà‚ñà‚ñè       | 67/300 [07:04<24:15,  6.25s/it]train/val metrics at epoch 68 | loss : 0.95/0.94 | micro_F1 : 0.37/0.31:  22%|‚ñà‚ñà‚ñè       | 67/300 [07:10<24:15,  6.25s/it]train/val metrics at epoch 68 | loss : 0.95/0.94 | micro_F1 : 0.37/0.31:  23%|‚ñà‚ñà‚ñé       | 68/300 [07:11<24:21,  6.30s/it]train/val metrics at epoch 69 | loss : 0.95/0.94 | micro_F1 : 0.37/0.30:  23%|‚ñà‚ñà‚ñé       | 68/300 [07:17<24:21,  6.30s/it]train/val metrics at epoch 69 | loss : 0.95/0.94 | micro_F1 : 0.37/0.30:  23%|‚ñà‚ñà‚ñé       | 69/300 [07:17<24:22,  6.33s/it]train/val metrics at epoch 70 | loss : 0.95/0.93 | micro_F1 : 0.37/0.31:  23%|‚ñà‚ñà‚ñé       | 69/300 [07:23<24:22,  6.33s/it]train/val metrics at epoch 70 | loss : 0.95/0.93 | micro_F1 : 0.37/0.31:  23%|‚ñà‚ñà‚ñé       | 70/300 [07:23<24:07,  6.29s/it]train/val metrics at epoch 71 | loss : 0.95/0.92 | micro_F1 : 0.37/0.31:  23%|‚ñà‚ñà‚ñé       | 70/300 [07:29<24:07,  6.29s/it]train/val metrics at epoch 71 | loss : 0.95/0.92 | micro_F1 : 0.37/0.31:  24%|‚ñà‚ñà‚ñé       | 71/300 [07:29<23:53,  6.26s/it]train/val metrics at epoch 72 | loss : 0.95/0.94 | micro_F1 : 0.37/0.34:  24%|‚ñà‚ñà‚ñé       | 71/300 [07:35<23:53,  6.26s/it]train/val metrics at epoch 72 | loss : 0.95/0.94 | micro_F1 : 0.37/0.34:  24%|‚ñà‚ñà‚ñç       | 72/300 [07:36<23:46,  6.26s/it]train/val metrics at epoch 73 | loss : 0.95/0.94 | micro_F1 : 0.37/0.31:  24%|‚ñà‚ñà‚ñç       | 72/300 [07:42<23:46,  6.26s/it]train/val metrics at epoch 73 | loss : 0.95/0.94 | micro_F1 : 0.37/0.31:  24%|‚ñà‚ñà‚ñç       | 73/300 [07:42<23:33,  6.23s/it]train/val metrics at epoch 74 | loss : 0.95/0.93 | micro_F1 : 0.37/0.31:  24%|‚ñà‚ñà‚ñç       | 73/300 [07:48<23:33,  6.23s/it]train/val metrics at epoch 74 | loss : 0.95/0.93 | micro_F1 : 0.37/0.31:  25%|‚ñà‚ñà‚ñç       | 74/300 [07:48<23:22,  6.20s/it]train/val metrics at epoch 75 | loss : 0.95/0.94 | micro_F1 : 0.37/0.31:  25%|‚ñà‚ñà‚ñç       | 74/300 [07:54<23:22,  6.20s/it]train/val metrics at epoch 75 | loss : 0.95/0.94 | micro_F1 : 0.37/0.31:  25%|‚ñà‚ñà‚ñå       | 75/300 [07:54<23:16,  6.21s/it]train/val metrics at epoch 76 | loss : 0.95/0.94 | micro_F1 : 0.37/0.32:  25%|‚ñà‚ñà‚ñå       | 75/300 [08:00<23:16,  6.21s/it]train/val metrics at epoch 76 | loss : 0.95/0.94 | micro_F1 : 0.37/0.32:  25%|‚ñà‚ñà‚ñå       | 75/300 [08:01<24:04,  6.42s/it]
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:          epoch ‚ñÅ
wandb:  learning rate ‚ñÅ
wandb:           time ‚ñÅ
wandb:     train loss ‚ñÅ
wandb: train macro F1 ‚ñÅ
wandb: train micro F1 ‚ñÅ
wandb:       val loss ‚ñÅ
wandb:   val macro F1 ‚ñÅ
wandb:   val micro F1 ‚ñÅ
wandb: 
wandb: Run summary:
wandb:          epoch 76
wandb:  learning rate 0.0
wandb:           time 483.17948
wandb:     train loss 0.95053
wandb: train macro F1 0.30593
wandb: train micro F1 0.37109
wandb:       val loss 0.93897
wandb:   val macro F1 0.21945
wandb:   val micro F1 0.31699
wandb: 
wandb: üöÄ View run good-salad-9 at: https://wandb.ai/msc-nicola/train_fusion_tuning/runs/qk6221os
wandb: Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230626_165353-qk6221os/logs
wandb: Currently logged in as: tha-santacruz (msc-nicola). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/santacro/masters_thesis/fusion_tuning/wandb/run-20230626_170229-nntmybhg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run leafy-meadow-13
wandb: ‚≠êÔ∏è View project at https://wandb.ai/msc-nicola/train_fusion_tuning
wandb: üöÄ View run at https://wandb.ai/msc-nicola/train_fusion_tuning/runs/nntmybhg
Running job on GPU : Tesla V100-PCIE-32GB
Namespace(BATCH_SIZE=128, CHECKPOINTS_PATH='/scratch/izar/santacro/checkpoints/', DATASET_PATH='/scratch/izar/santacro/final_data/', DEVICE='cuda:0', EMBEDDING='longformer', EPOCH_NUM=300, FRACTION=40, FUSION='sum', HIDDEN_SIZE=8192, LEARNING_RATE=1e-05, LEVEL='L1', LOAD_CHECKPOINT='no', MERGE_METHOD='fusion', MIN_LEARNING_RATE=1e-06, NORMALIZE='yes', NUM_WORKERS=8, RANDOM_STATE=1, RUN_MODE='train', SAVE_CHECKPOINTS='yes', SPLITTING='species', TARGET_BASE='set', WANDB_ENTITY='msc-nicola', WANDB_LOGS='yes', WANDB_PROJECT='fusion_tuning')
  0%|          | 0/300 [00:00<?, ?it/s]train/val metrics at epoch 1 | loss : 1.20/1.06 | micro_F1 : 0.19/0.16:   0%|          | 0/300 [00:06<?, ?it/s]train/val metrics at epoch 1 | loss : 1.20/1.06 | micro_F1 : 0.19/0.16:   0%|          | 1/300 [00:06<33:12,  6.66s/it]train/val metrics at epoch 2 | loss : 1.19/1.05 | micro_F1 : 0.20/0.17:   0%|          | 1/300 [00:12<33:12,  6.66s/it]train/val metrics at epoch 2 | loss : 1.19/1.05 | micro_F1 : 0.20/0.17:   1%|          | 2/300 [00:12<31:53,  6.42s/it]train/val metrics at epoch 3 | loss : 1.18/1.05 | micro_F1 : 0.21/0.19:   1%|          | 2/300 [00:19<31:53,  6.42s/it]train/val metrics at epoch 3 | loss : 1.18/1.05 | micro_F1 : 0.21/0.19:   1%|          | 3/300 [00:19<31:45,  6.42s/it]train/val metrics at epoch 4 | loss : 1.17/1.05 | micro_F1 : 0.22/0.19:   1%|          | 3/300 [00:25<31:45,  6.42s/it]train/val metrics at epoch 4 | loss : 1.17/1.05 | micro_F1 : 0.22/0.19:   1%|‚ñè         | 4/300 [00:25<31:04,  6.30s/it]train/val metrics at epoch 5 | loss : 1.16/1.04 | micro_F1 : 0.23/0.20:   1%|‚ñè         | 4/300 [00:31<31:04,  6.30s/it]train/val metrics at epoch 5 | loss : 1.16/1.04 | micro_F1 : 0.23/0.20:   2%|‚ñè         | 5/300 [00:31<31:02,  6.32s/it]train/val metrics at epoch 6 | loss : 1.15/1.04 | micro_F1 : 0.24/0.22:   2%|‚ñè         | 5/300 [00:37<31:02,  6.32s/it]train/val metrics at epoch 6 | loss : 1.15/1.04 | micro_F1 : 0.24/0.22:   2%|‚ñè         | 6/300 [00:38<30:56,  6.32s/it]train/val metrics at epoch 7 | loss : 1.14/1.02 | micro_F1 : 0.24/0.22:   2%|‚ñè         | 6/300 [00:44<30:56,  6.32s/it]train/val metrics at epoch 7 | loss : 1.14/1.02 | micro_F1 : 0.24/0.22:   2%|‚ñè         | 7/300 [00:44<31:04,  6.36s/it]train/val metrics at epoch 8 | loss : 1.13/1.01 | micro_F1 : 0.26/0.25:   2%|‚ñè         | 7/300 [00:50<31:04,  6.36s/it]train/val metrics at epoch 8 | loss : 1.13/1.01 | micro_F1 : 0.26/0.25:   3%|‚ñé         | 8/300 [00:50<31:03,  6.38s/it]train/val metrics at epoch 9 | loss : 1.12/0.99 | micro_F1 : 0.27/0.26:   3%|‚ñé         | 8/300 [00:57<31:03,  6.38s/it]train/val metrics at epoch 9 | loss : 1.12/0.99 | micro_F1 : 0.27/0.26:   3%|‚ñé         | 9/300 [00:57<31:06,  6.41s/it]train/val metrics at epoch 10 | loss : 1.11/0.99 | micro_F1 : 0.28/0.27:   3%|‚ñé         | 9/300 [01:03<31:06,  6.41s/it]train/val metrics at epoch 10 | loss : 1.11/0.99 | micro_F1 : 0.28/0.27:   3%|‚ñé         | 10/300 [01:03<30:43,  6.36s/it]train/val metrics at epoch 11 | loss : 1.10/0.97 | micro_F1 : 0.29/0.30:   3%|‚ñé         | 10/300 [01:09<30:43,  6.36s/it]train/val metrics at epoch 11 | loss : 1.10/0.97 | micro_F1 : 0.29/0.30:   4%|‚ñé         | 11/300 [01:09<30:26,  6.32s/it]train/val metrics at epoch 12 | loss : 1.09/0.97 | micro_F1 : 0.30/0.30:   4%|‚ñé         | 11/300 [01:15<30:26,  6.32s/it]train/val metrics at epoch 12 | loss : 1.09/0.97 | micro_F1 : 0.30/0.30:   4%|‚ñç         | 12/300 [01:16<30:01,  6.26s/it]train/val metrics at epoch 13 | loss : 1.08/0.96 | micro_F1 : 0.31/0.31:   4%|‚ñç         | 12/300 [01:22<30:01,  6.26s/it]train/val metrics at epoch 13 | loss : 1.08/0.96 | micro_F1 : 0.31/0.31:   4%|‚ñç         | 13/300 [01:22<30:10,  6.31s/it]train/val metrics at epoch 14 | loss : 1.07/0.96 | micro_F1 : 0.32/0.31:   4%|‚ñç         | 13/300 [01:28<30:10,  6.31s/it]train/val metrics at epoch 14 | loss : 1.07/0.96 | micro_F1 : 0.32/0.31:   5%|‚ñç         | 14/300 [01:28<30:09,  6.33s/it]train/val metrics at epoch 15 | loss : 1.06/0.95 | micro_F1 : 0.32/0.32:   5%|‚ñç         | 14/300 [01:35<30:09,  6.33s/it]train/val metrics at epoch 15 | loss : 1.06/0.95 | micro_F1 : 0.32/0.32:   5%|‚ñå         | 15/300 [01:35<30:09,  6.35s/it]train/val metrics at epoch 16 | loss : 1.05/0.95 | micro_F1 : 0.32/0.32:   5%|‚ñå         | 15/300 [01:41<30:09,  6.35s/it]train/val metrics at epoch 16 | loss : 1.05/0.95 | micro_F1 : 0.32/0.32:   5%|‚ñå         | 16/300 [01:41<29:52,  6.31s/it]train/val metrics at epoch 17 | loss : 1.04/0.94 | micro_F1 : 0.33/0.34:   5%|‚ñå         | 16/300 [01:47<29:52,  6.31s/it]train/val metrics at epoch 17 | loss : 1.04/0.94 | micro_F1 : 0.33/0.34:   6%|‚ñå         | 17/300 [01:47<29:35,  6.27s/it]train/val metrics at epoch 18 | loss : 1.03/0.94 | micro_F1 : 0.33/0.33:   6%|‚ñå         | 17/300 [01:53<29:35,  6.27s/it]train/val metrics at epoch 18 | loss : 1.03/0.94 | micro_F1 : 0.33/0.33:   6%|‚ñå         | 18/300 [01:54<29:37,  6.30s/it]train/val metrics at epoch 19 | loss : 1.03/0.94 | micro_F1 : 0.34/0.33:   6%|‚ñå         | 18/300 [01:59<29:37,  6.30s/it]train/val metrics at epoch 19 | loss : 1.03/0.94 | micro_F1 : 0.34/0.33:   6%|‚ñã         | 19/300 [02:00<29:20,  6.26s/it]train/val metrics at epoch 20 | loss : 1.02/0.94 | micro_F1 : 0.34/0.33:   6%|‚ñã         | 19/300 [02:06<29:20,  6.26s/it]train/val metrics at epoch 20 | loss : 1.02/0.94 | micro_F1 : 0.34/0.33:   7%|‚ñã         | 20/300 [02:06<29:11,  6.26s/it]train/val metrics at epoch 21 | loss : 1.01/0.93 | micro_F1 : 0.34/0.33:   7%|‚ñã         | 20/300 [02:12<29:11,  6.26s/it]train/val metrics at epoch 21 | loss : 1.01/0.93 | micro_F1 : 0.34/0.33:   7%|‚ñã         | 21/300 [02:12<29:24,  6.33s/it]train/val metrics at epoch 22 | loss : 1.01/0.93 | micro_F1 : 0.34/0.35:   7%|‚ñã         | 21/300 [02:18<29:24,  6.33s/it]train/val metrics at epoch 22 | loss : 1.01/0.93 | micro_F1 : 0.34/0.35:   7%|‚ñã         | 22/300 [02:19<29:13,  6.31s/it]train/val metrics at epoch 23 | loss : 1.00/0.93 | micro_F1 : 0.35/0.33:   7%|‚ñã         | 22/300 [02:25<29:13,  6.31s/it]train/val metrics at epoch 23 | loss : 1.00/0.93 | micro_F1 : 0.35/0.33:   8%|‚ñä         | 23/300 [02:25<28:52,  6.26s/it]train/val metrics at epoch 24 | loss : 0.99/0.93 | micro_F1 : 0.34/0.35:   8%|‚ñä         | 23/300 [02:31<28:52,  6.26s/it]train/val metrics at epoch 24 | loss : 0.99/0.93 | micro_F1 : 0.34/0.35:   8%|‚ñä         | 24/300 [02:31<28:47,  6.26s/it]train/val metrics at epoch 25 | loss : 0.99/0.92 | micro_F1 : 0.35/0.33:   8%|‚ñä         | 24/300 [02:37<28:47,  6.26s/it]train/val metrics at epoch 25 | loss : 0.99/0.92 | micro_F1 : 0.35/0.33:   8%|‚ñä         | 25/300 [02:38<28:57,  6.32s/it]train/val metrics at epoch 26 | loss : 0.98/0.92 | micro_F1 : 0.35/0.33:   8%|‚ñä         | 25/300 [02:43<28:57,  6.32s/it]train/val metrics at epoch 26 | loss : 0.98/0.92 | micro_F1 : 0.35/0.33:   9%|‚ñä         | 26/300 [02:44<28:33,  6.25s/it]train/val metrics at epoch 27 | loss : 0.97/0.92 | micro_F1 : 0.36/0.33:   9%|‚ñä         | 26/300 [02:50<28:33,  6.25s/it]train/val metrics at epoch 27 | loss : 0.97/0.92 | micro_F1 : 0.36/0.33:   9%|‚ñâ         | 27/300 [02:50<28:35,  6.28s/it]train/val metrics at epoch 28 | loss : 0.97/0.93 | micro_F1 : 0.36/0.33:   9%|‚ñâ         | 27/300 [02:56<28:35,  6.28s/it]train/val metrics at epoch 28 | loss : 0.97/0.93 | micro_F1 : 0.36/0.33:   9%|‚ñâ         | 28/300 [02:56<28:41,  6.33s/it]train/val metrics at epoch 29 | loss : 0.97/0.92 | micro_F1 : 0.35/0.33:   9%|‚ñâ         | 28/300 [03:03<28:41,  6.33s/it]train/val metrics at epoch 29 | loss : 0.97/0.92 | micro_F1 : 0.35/0.33:  10%|‚ñâ         | 29/300 [03:03<28:43,  6.36s/it]train/val metrics at epoch 30 | loss : 0.96/0.93 | micro_F1 : 0.36/0.33:  10%|‚ñâ         | 29/300 [03:09<28:43,  6.36s/it]train/val metrics at epoch 30 | loss : 0.96/0.93 | micro_F1 : 0.36/0.33:  10%|‚ñà         | 30/300 [03:09<28:37,  6.36s/it]train/val metrics at epoch 31 | loss : 0.96/0.92 | micro_F1 : 0.36/0.33:  10%|‚ñà         | 30/300 [03:15<28:37,  6.36s/it]train/val metrics at epoch 31 | loss : 0.96/0.92 | micro_F1 : 0.36/0.33:  10%|‚ñà         | 31/300 [03:16<28:34,  6.37s/it]train/val metrics at epoch 32 | loss : 0.96/0.93 | micro_F1 : 0.36/0.33:  10%|‚ñà         | 31/300 [03:22<28:34,  6.37s/it]train/val metrics at epoch 32 | loss : 0.96/0.93 | micro_F1 : 0.36/0.33:  11%|‚ñà         | 32/300 [03:22<28:11,  6.31s/it]train/val metrics at epoch 33 | loss : 0.96/0.92 | micro_F1 : 0.36/0.33:  11%|‚ñà         | 32/300 [03:28<28:11,  6.31s/it]train/val metrics at epoch 33 | loss : 0.96/0.92 | micro_F1 : 0.36/0.33:  11%|‚ñà         | 33/300 [03:28<28:01,  6.30s/it]train/val metrics at epoch 34 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  11%|‚ñà         | 33/300 [03:34<28:01,  6.30s/it]train/val metrics at epoch 34 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  11%|‚ñà‚ñè        | 34/300 [03:34<27:53,  6.29s/it]train/val metrics at epoch 35 | loss : 0.96/0.92 | micro_F1 : 0.36/0.33:  11%|‚ñà‚ñè        | 34/300 [03:40<27:53,  6.29s/it]train/val metrics at epoch 35 | loss : 0.96/0.92 | micro_F1 : 0.36/0.33:  12%|‚ñà‚ñè        | 35/300 [03:41<27:44,  6.28s/it]train/val metrics at epoch 36 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  12%|‚ñà‚ñè        | 35/300 [03:47<27:44,  6.28s/it]train/val metrics at epoch 36 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  12%|‚ñà‚ñè        | 36/300 [03:47<27:49,  6.32s/it]train/val metrics at epoch 37 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  12%|‚ñà‚ñè        | 36/300 [03:53<27:49,  6.32s/it]train/val metrics at epoch 37 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  12%|‚ñà‚ñè        | 37/300 [03:53<27:28,  6.27s/it]train/val metrics at epoch 38 | loss : 0.96/0.93 | micro_F1 : 0.36/0.33:  12%|‚ñà‚ñè        | 37/300 [03:59<27:28,  6.27s/it]train/val metrics at epoch 38 | loss : 0.96/0.93 | micro_F1 : 0.36/0.33:  13%|‚ñà‚ñé        | 38/300 [04:00<27:39,  6.34s/it]train/val metrics at epoch 39 | loss : 0.96/0.92 | micro_F1 : 0.36/0.32:  13%|‚ñà‚ñé        | 38/300 [04:06<27:39,  6.34s/it]train/val metrics at epoch 39 | loss : 0.96/0.92 | micro_F1 : 0.36/0.32:  13%|‚ñà‚ñé        | 39/300 [04:06<27:29,  6.32s/it]train/val metrics at epoch 40 | loss : 0.95/0.93 | micro_F1 : 0.36/0.32:  13%|‚ñà‚ñé        | 39/300 [04:12<27:29,  6.32s/it]train/val metrics at epoch 40 | loss : 0.95/0.93 | micro_F1 : 0.36/0.32:  13%|‚ñà‚ñé        | 40/300 [04:12<27:20,  6.31s/it]train/val metrics at epoch 41 | loss : 0.95/0.93 | micro_F1 : 0.36/0.32:  13%|‚ñà‚ñé        | 40/300 [04:18<27:20,  6.31s/it]train/val metrics at epoch 41 | loss : 0.95/0.93 | micro_F1 : 0.36/0.32:  14%|‚ñà‚ñé        | 41/300 [04:19<27:27,  6.36s/it]train/val metrics at epoch 42 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  14%|‚ñà‚ñé        | 41/300 [04:25<27:27,  6.36s/it]train/val metrics at epoch 42 | loss : 0.96/0.93 | micro_F1 : 0.36/0.32:  14%|‚ñà‚ñç        | 42/300 [04:25<27:29,  6.39s/it]train/val metrics at epoch 43 | loss : 0.95/0.93 | micro_F1 : 0.36/0.32:  14%|‚ñà‚ñç        | 42/300 [04:31<27:29,  6.39s/it]train/val metrics at epoch 43 | loss : 0.95/0.93 | micro_F1 : 0.36/0.32:  14%|‚ñà‚ñç        | 42/300 [04:32<27:53,  6.49s/it]
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:          epoch ‚ñÅ
wandb:  learning rate ‚ñÅ
wandb:           time ‚ñÅ
wandb:     train loss ‚ñÅ
wandb: train macro F1 ‚ñÅ
wandb: train micro F1 ‚ñÅ
wandb:       val loss ‚ñÅ
wandb:   val macro F1 ‚ñÅ
wandb:   val micro F1 ‚ñÅ
wandb: 
wandb: Run summary:
wandb:          epoch 43
wandb:  learning rate 0.0
wandb:           time 273.98555
wandb:     train loss 0.95402
wandb: train macro F1 0.2998
wandb: train micro F1 0.36069
wandb:       val loss 0.9259
wandb:   val macro F1 0.22401
wandb:   val micro F1 0.31988
wandb: 
wandb: üöÄ View run leafy-meadow-13 at: https://wandb.ai/msc-nicola/train_fusion_tuning/runs/nntmybhg
wandb: Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230626_170229-nntmybhg/logs
wandb: Currently logged in as: tha-santacruz (msc-nicola). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/santacro/masters_thesis/fusion_tuning/wandb/run-20230626_170745-osmigcd0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run comic-tree-15
wandb: ‚≠êÔ∏è View project at https://wandb.ai/msc-nicola/train_fusion_tuning
wandb: üöÄ View run at https://wandb.ai/msc-nicola/train_fusion_tuning/runs/osmigcd0
Running job on GPU : Tesla V100-PCIE-32GB
Namespace(BATCH_SIZE=128, CHECKPOINTS_PATH='/scratch/izar/santacro/checkpoints/', DATASET_PATH='/scratch/izar/santacro/final_data/', DEVICE='cuda:0', EMBEDDING='longformer', EPOCH_NUM=300, FRACTION=40, FUSION='max', HIDDEN_SIZE=8192, LEARNING_RATE=1e-05, LEVEL='L1', LOAD_CHECKPOINT='no', MERGE_METHOD='fusion', MIN_LEARNING_RATE=1e-06, NORMALIZE='no', NUM_WORKERS=8, RANDOM_STATE=1, RUN_MODE='train', SAVE_CHECKPOINTS='yes', SPLITTING='species', TARGET_BASE='set', WANDB_ENTITY='msc-nicola', WANDB_LOGS='yes', WANDB_PROJECT='fusion_tuning')
  0%|          | 0/300 [00:00<?, ?it/s]train/val metrics at epoch 1 | loss : 1.16/1.05 | micro_F1 : 0.22/0.20:   0%|          | 0/300 [00:06<?, ?it/s]train/val metrics at epoch 1 | loss : 1.16/1.05 | micro_F1 : 0.22/0.20:   0%|          | 1/300 [00:06<33:58,  6.82s/it]train/val metrics at epoch 2 | loss : 1.11/1.03 | micro_F1 : 0.27/0.26:   0%|          | 1/300 [00:12<33:58,  6.82s/it]train/val metrics at epoch 2 | loss : 1.11/1.03 | micro_F1 : 0.27/0.26:   1%|          | 2/300 [00:13<32:21,  6.52s/it]train/val metrics at epoch 3 | loss : 1.08/1.01 | micro_F1 : 0.30/0.27:   1%|          | 2/300 [00:19<32:21,  6.52s/it]train/val metrics at epoch 3 | loss : 1.08/1.01 | micro_F1 : 0.30/0.27:   1%|          | 3/300 [00:19<31:26,  6.35s/it]train/val metrics at epoch 4 | loss : 1.06/1.01 | micro_F1 : 0.31/0.27:   1%|          | 3/300 [00:25<31:26,  6.35s/it]train/val metrics at epoch 4 | loss : 1.06/1.01 | micro_F1 : 0.31/0.27:   1%|‚ñè         | 4/300 [00:25<31:25,  6.37s/it]train/val metrics at epoch 5 | loss : 1.04/0.99 | micro_F1 : 0.33/0.29:   1%|‚ñè         | 4/300 [00:31<31:25,  6.37s/it]train/val metrics at epoch 5 | loss : 1.04/0.99 | micro_F1 : 0.33/0.29:   2%|‚ñè         | 5/300 [00:31<31:10,  6.34s/it]train/val metrics at epoch 6 | loss : 1.02/0.99 | micro_F1 : 0.34/0.32:   2%|‚ñè         | 5/300 [00:38<31:10,  6.34s/it]train/val metrics at epoch 6 | loss : 1.02/0.99 | micro_F1 : 0.34/0.32:   2%|‚ñè         | 6/300 [00:38<31:14,  6.38s/it]train/val metrics at epoch 7 | loss : 1.00/0.98 | micro_F1 : 0.35/0.38:   2%|‚ñè         | 6/300 [00:44<31:14,  6.38s/it]train/val metrics at epoch 7 | loss : 1.00/0.98 | micro_F1 : 0.35/0.38:   2%|‚ñè         | 7/300 [00:44<30:50,  6.31s/it]train/val metrics at epoch 8 | loss : 0.98/0.96 | micro_F1 : 0.36/0.34:   2%|‚ñè         | 7/300 [00:50<30:50,  6.31s/it]train/val metrics at epoch 8 | loss : 0.98/0.96 | micro_F1 : 0.36/0.34:   3%|‚ñé         | 8/300 [00:50<30:28,  6.26s/it]train/val metrics at epoch 9 | loss : 0.96/0.95 | micro_F1 : 0.37/0.31:   3%|‚ñé         | 8/300 [00:56<30:28,  6.26s/it]train/val metrics at epoch 9 | loss : 0.96/0.95 | micro_F1 : 0.37/0.31:   3%|‚ñé         | 9/300 [00:57<30:21,  6.26s/it]train/val metrics at epoch 10 | loss : 0.94/0.94 | micro_F1 : 0.37/0.32:   3%|‚ñé         | 9/300 [01:03<30:21,  6.26s/it]train/val metrics at epoch 10 | loss : 0.94/0.94 | micro_F1 : 0.37/0.32:   3%|‚ñé         | 10/300 [01:03<30:37,  6.34s/it]train/val metrics at epoch 11 | loss : 0.93/0.93 | micro_F1 : 0.38/0.35:   3%|‚ñé         | 10/300 [01:09<30:37,  6.34s/it]train/val metrics at epoch 11 | loss : 0.93/0.93 | micro_F1 : 0.38/0.35:   4%|‚ñé         | 11/300 [01:09<30:14,  6.28s/it]train/val metrics at epoch 12 | loss : 0.92/0.95 | micro_F1 : 0.38/0.34:   4%|‚ñé         | 11/300 [01:15<30:14,  6.28s/it]train/val metrics at epoch 12 | loss : 0.92/0.95 | micro_F1 : 0.38/0.34:   4%|‚ñç         | 12/300 [01:15<29:56,  6.24s/it]train/val metrics at epoch 13 | loss : 0.90/0.93 | micro_F1 : 0.39/0.33:   4%|‚ñç         | 12/300 [01:21<29:56,  6.24s/it]train/val metrics at epoch 13 | loss : 0.90/0.93 | micro_F1 : 0.39/0.33:   4%|‚ñç         | 13/300 [01:21<29:42,  6.21s/it]train/val metrics at epoch 14 | loss : 0.89/1.05 | micro_F1 : 0.39/0.37:   4%|‚ñç         | 13/300 [01:28<29:42,  6.21s/it]train/val metrics at epoch 14 | loss : 0.89/1.05 | micro_F1 : 0.39/0.37:   5%|‚ñç         | 14/300 [01:28<29:39,  6.22s/it]train/val metrics at epoch 15 | loss : 0.88/0.94 | micro_F1 : 0.40/0.37:   5%|‚ñç         | 14/300 [01:34<29:39,  6.22s/it]train/val metrics at epoch 15 | loss : 0.88/0.94 | micro_F1 : 0.40/0.37:   5%|‚ñå         | 15/300 [01:34<29:25,  6.19s/it]train/val metrics at epoch 16 | loss : 0.86/0.95 | micro_F1 : 0.40/0.35:   5%|‚ñå         | 15/300 [01:40<29:25,  6.19s/it]train/val metrics at epoch 16 | loss : 0.86/0.95 | micro_F1 : 0.40/0.35:   5%|‚ñå         | 16/300 [01:40<29:34,  6.25s/it]train/val metrics at epoch 17 | loss : 0.85/0.93 | micro_F1 : 0.41/0.31:   5%|‚ñå         | 16/300 [01:46<29:34,  6.25s/it]train/val metrics at epoch 17 | loss : 0.85/0.93 | micro_F1 : 0.41/0.31:   6%|‚ñå         | 17/300 [01:46<29:28,  6.25s/it]train/val metrics at epoch 18 | loss : 0.85/0.95 | micro_F1 : 0.41/0.36:   6%|‚ñå         | 17/300 [01:53<29:28,  6.25s/it]train/val metrics at epoch 18 | loss : 0.85/0.95 | micro_F1 : 0.41/0.36:   6%|‚ñå         | 18/300 [01:53<29:25,  6.26s/it]train/val metrics at epoch 19 | loss : 0.84/0.93 | micro_F1 : 0.41/0.35:   6%|‚ñå         | 18/300 [01:59<29:25,  6.26s/it]train/val metrics at epoch 19 | loss : 0.84/0.93 | micro_F1 : 0.41/0.35:   6%|‚ñã         | 19/300 [01:59<29:16,  6.25s/it]train/val metrics at epoch 20 | loss : 0.83/0.93 | micro_F1 : 0.42/0.33:   6%|‚ñã         | 19/300 [02:05<29:16,  6.25s/it]train/val metrics at epoch 20 | loss : 0.83/0.93 | micro_F1 : 0.42/0.33:   7%|‚ñã         | 20/300 [02:05<29:02,  6.22s/it]train/val metrics at epoch 21 | loss : 0.83/0.93 | micro_F1 : 0.41/0.34:   7%|‚ñã         | 20/300 [02:11<29:02,  6.22s/it]train/val metrics at epoch 21 | loss : 0.83/0.93 | micro_F1 : 0.41/0.34:   7%|‚ñã         | 21/300 [02:12<29:13,  6.28s/it]train/val metrics at epoch 22 | loss : 0.83/0.92 | micro_F1 : 0.42/0.36:   7%|‚ñã         | 21/300 [02:18<29:13,  6.28s/it]train/val metrics at epoch 22 | loss : 0.83/0.92 | micro_F1 : 0.42/0.36:   7%|‚ñã         | 22/300 [02:18<28:57,  6.25s/it]train/val metrics at epoch 23 | loss : 0.82/0.93 | micro_F1 : 0.42/0.34:   7%|‚ñã         | 22/300 [02:24<28:57,  6.25s/it]train/val metrics at epoch 23 | loss : 0.82/0.93 | micro_F1 : 0.42/0.34:   8%|‚ñä         | 23/300 [02:24<29:03,  6.30s/it]train/val metrics at epoch 24 | loss : 0.82/0.92 | micro_F1 : 0.42/0.35:   8%|‚ñä         | 23/300 [02:30<29:03,  6.30s/it]train/val metrics at epoch 24 | loss : 0.82/0.92 | micro_F1 : 0.42/0.35:   8%|‚ñä         | 24/300 [02:30<28:50,  6.27s/it]train/val metrics at epoch 25 | loss : 0.82/0.92 | micro_F1 : 0.42/0.36:   8%|‚ñä         | 24/300 [02:36<28:50,  6.27s/it]train/val metrics at epoch 25 | loss : 0.82/0.92 | micro_F1 : 0.42/0.36:   8%|‚ñä         | 25/300 [02:37<28:39,  6.25s/it]train/val metrics at epoch 26 | loss : 0.82/0.92 | micro_F1 : 0.42/0.35:   8%|‚ñä         | 25/300 [02:42<28:39,  6.25s/it]train/val metrics at epoch 26 | loss : 0.82/0.92 | micro_F1 : 0.42/0.35:   9%|‚ñä         | 26/300 [02:43<28:22,  6.21s/it]train/val metrics at epoch 27 | loss : 0.82/0.93 | micro_F1 : 0.42/0.35:   9%|‚ñä         | 26/300 [02:49<28:22,  6.21s/it]train/val metrics at epoch 27 | loss : 0.82/0.93 | micro_F1 : 0.42/0.35:   9%|‚ñâ         | 27/300 [02:49<28:17,  6.22s/it]train/val metrics at epoch 28 | loss : 0.82/0.93 | micro_F1 : 0.42/0.35:   9%|‚ñâ         | 27/300 [02:55<28:17,  6.22s/it]train/val metrics at epoch 28 | loss : 0.82/0.93 | micro_F1 : 0.42/0.35:   9%|‚ñâ         | 28/300 [02:55<28:25,  6.27s/it]train/val metrics at epoch 29 | loss : 0.81/0.92 | micro_F1 : 0.42/0.34:   9%|‚ñâ         | 28/300 [03:02<28:25,  6.27s/it]train/val metrics at epoch 29 | loss : 0.81/0.92 | micro_F1 : 0.42/0.34:  10%|‚ñâ         | 29/300 [03:02<28:31,  6.32s/it]train/val metrics at epoch 30 | loss : 0.81/0.92 | micro_F1 : 0.42/0.34:  10%|‚ñâ         | 29/300 [03:08<28:31,  6.32s/it]train/val metrics at epoch 30 | loss : 0.81/0.92 | micro_F1 : 0.42/0.34:  10%|‚ñà         | 30/300 [03:08<28:18,  6.29s/it]train/val metrics at epoch 31 | loss : 0.81/0.92 | micro_F1 : 0.43/0.36:  10%|‚ñà         | 30/300 [03:14<28:18,  6.29s/it]train/val metrics at epoch 31 | loss : 0.81/0.92 | micro_F1 : 0.43/0.36:  10%|‚ñà         | 31/300 [03:14<28:04,  6.26s/it]train/val metrics at epoch 32 | loss : 0.81/0.93 | micro_F1 : 0.43/0.36:  10%|‚ñà         | 31/300 [03:20<28:04,  6.26s/it]train/val metrics at epoch 32 | loss : 0.81/0.93 | micro_F1 : 0.43/0.36:  11%|‚ñà         | 32/300 [03:20<27:58,  6.26s/it]train/val metrics at epoch 33 | loss : 0.81/0.91 | micro_F1 : 0.42/0.34:  11%|‚ñà         | 32/300 [03:26<27:58,  6.26s/it]train/val metrics at epoch 33 | loss : 0.81/0.91 | micro_F1 : 0.42/0.34:  11%|‚ñà         | 33/300 [03:27<27:45,  6.24s/it]train/val metrics at epoch 34 | loss : 0.81/0.93 | micro_F1 : 0.43/0.36:  11%|‚ñà         | 33/300 [03:33<27:45,  6.24s/it]train/val metrics at epoch 34 | loss : 0.81/0.93 | micro_F1 : 0.43/0.36:  11%|‚ñà‚ñè        | 34/300 [03:33<27:47,  6.27s/it]train/val metrics at epoch 35 | loss : 0.81/0.92 | micro_F1 : 0.42/0.35:  11%|‚ñà‚ñè        | 34/300 [03:39<27:47,  6.27s/it]train/val metrics at epoch 35 | loss : 0.81/0.92 | micro_F1 : 0.42/0.35:  12%|‚ñà‚ñè        | 35/300 [03:39<27:34,  6.24s/it]train/val metrics at epoch 36 | loss : 0.80/0.92 | micro_F1 : 0.43/0.35:  12%|‚ñà‚ñè        | 35/300 [03:45<27:34,  6.24s/it]train/val metrics at epoch 36 | loss : 0.80/0.92 | micro_F1 : 0.43/0.35:  12%|‚ñà‚ñè        | 36/300 [03:46<27:42,  6.30s/it]train/val metrics at epoch 37 | loss : 0.81/0.93 | micro_F1 : 0.43/0.35:  12%|‚ñà‚ñè        | 36/300 [03:52<27:42,  6.30s/it]train/val metrics at epoch 37 | loss : 0.81/0.93 | micro_F1 : 0.43/0.35:  12%|‚ñà‚ñè        | 37/300 [03:52<27:28,  6.27s/it]train/val metrics at epoch 38 | loss : 0.80/0.93 | micro_F1 : 0.43/0.36:  12%|‚ñà‚ñè        | 37/300 [03:58<27:28,  6.27s/it]train/val metrics at epoch 38 | loss : 0.80/0.93 | micro_F1 : 0.43/0.36:  13%|‚ñà‚ñé        | 38/300 [03:58<27:16,  6.25s/it]train/val metrics at epoch 39 | loss : 0.80/0.92 | micro_F1 : 0.43/0.34:  13%|‚ñà‚ñé        | 38/300 [04:04<27:16,  6.25s/it]train/val metrics at epoch 39 | loss : 0.80/0.92 | micro_F1 : 0.43/0.34:  13%|‚ñà‚ñé        | 39/300 [04:04<27:11,  6.25s/it]train/val metrics at epoch 40 | loss : 0.80/0.93 | micro_F1 : 0.43/0.34:  13%|‚ñà‚ñé        | 39/300 [04:10<27:11,  6.25s/it]train/val metrics at epoch 40 | loss : 0.80/0.93 | micro_F1 : 0.43/0.34:  13%|‚ñà‚ñé        | 40/300 [04:10<26:55,  6.21s/it]train/val metrics at epoch 41 | loss : 0.80/0.93 | micro_F1 : 0.43/0.35:  13%|‚ñà‚ñé        | 40/300 [04:16<26:55,  6.21s/it]train/val metrics at epoch 41 | loss : 0.80/0.93 | micro_F1 : 0.43/0.35:  14%|‚ñà‚ñé        | 41/300 [04:16<26:44,  6.19s/it]train/val metrics at epoch 42 | loss : 0.80/0.94 | micro_F1 : 0.43/0.35:  14%|‚ñà‚ñé        | 41/300 [04:23<26:44,  6.19s/it]train/val metrics at epoch 42 | loss : 0.80/0.94 | micro_F1 : 0.43/0.35:  14%|‚ñà‚ñç        | 42/300 [04:23<26:51,  6.25s/it]train/val metrics at epoch 43 | loss : 0.80/0.94 | micro_F1 : 0.43/0.36:  14%|‚ñà‚ñç        | 42/300 [04:29<26:51,  6.25s/it]train/val metrics at epoch 43 | loss : 0.80/0.94 | micro_F1 : 0.43/0.36:  14%|‚ñà‚ñç        | 42/300 [04:30<27:38,  6.43s/it]
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:          epoch ‚ñÅ
wandb:  learning rate ‚ñÅ
wandb:           time ‚ñÅ
wandb:     train loss ‚ñÅ
wandb: train macro F1 ‚ñÅ
wandb: train micro F1 ‚ñÅ
wandb:       val loss ‚ñÅ
wandb:   val macro F1 ‚ñÅ
wandb:   val micro F1 ‚ñÅ
wandb: 
wandb: Run summary:
wandb:          epoch 43
wandb:  learning rate 0.0
wandb:           time 271.64031
wandb:     train loss 0.79765
wandb: train macro F1 0.36403
wandb: train micro F1 0.42744
wandb:       val loss 0.9359
wandb:   val macro F1 0.24252
wandb:   val micro F1 0.35503
wandb: 
wandb: üöÄ View run comic-tree-15 at: https://wandb.ai/msc-nicola/train_fusion_tuning/runs/osmigcd0
wandb: Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230626_170745-osmigcd0/logs
wandb: Currently logged in as: tha-santacruz (msc-nicola). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.4
wandb: Run data is saved locally in /home/santacro/masters_thesis/fusion_tuning/wandb/run-20230626_171247-wbrje1lw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run proud-shape-16
wandb: ‚≠êÔ∏è View project at https://wandb.ai/msc-nicola/train_fusion_tuning
wandb: üöÄ View run at https://wandb.ai/msc-nicola/train_fusion_tuning/runs/wbrje1lw
Running job on GPU : Tesla V100-PCIE-32GB
Namespace(BATCH_SIZE=128, CHECKPOINTS_PATH='/scratch/izar/santacro/checkpoints/', DATASET_PATH='/scratch/izar/santacro/final_data/', DEVICE='cuda:0', EMBEDDING='longformer', EPOCH_NUM=300, FRACTION=40, FUSION='max', HIDDEN_SIZE=8192, LEARNING_RATE=1e-05, LEVEL='L1', LOAD_CHECKPOINT='no', MERGE_METHOD='fusion', MIN_LEARNING_RATE=1e-06, NORMALIZE='yes', NUM_WORKERS=8, RANDOM_STATE=1, RUN_MODE='train', SAVE_CHECKPOINTS='yes', SPLITTING='species', TARGET_BASE='set', WANDB_ENTITY='msc-nicola', WANDB_LOGS='yes', WANDB_PROJECT='fusion_tuning')
  0%|          | 0/300 [00:00<?, ?it/s]train/val metrics at epoch 1 | loss : 1.18/1.06 | micro_F1 : 0.21/0.17:   0%|          | 0/300 [00:06<?, ?it/s]train/val metrics at epoch 1 | loss : 1.18/1.06 | micro_F1 : 0.21/0.17:   0%|          | 1/300 [00:06<33:37,  6.75s/it]train/val metrics at epoch 2 | loss : 1.14/1.04 | micro_F1 : 0.24/0.22:   0%|          | 1/300 [00:12<33:37,  6.75s/it]train/val metrics at epoch 2 | loss : 1.14/1.04 | micro_F1 : 0.24/0.22:   1%|          | 2/300 [00:12<31:56,  6.43s/it]train/val metrics at epoch 3 | loss : 1.12/1.03 | micro_F1 : 0.27/0.24:   1%|          | 2/300 [00:19<31:56,  6.43s/it]train/val metrics at epoch 3 | loss : 1.12/1.03 | micro_F1 : 0.27/0.24:   1%|          | 3/300 [00:19<31:23,  6.34s/it]train/val metrics at epoch 4 | loss : 1.10/1.02 | micro_F1 : 0.28/0.26:   1%|          | 3/300 [00:25<31:23,  6.34s/it]train/val metrics at epoch 4 | loss : 1.10/1.02 | micro_F1 : 0.28/0.26:   1%|‚ñè         | 4/300 [00:25<31:07,  6.31s/it]train/val metrics at epoch 5 | loss : 1.09/1.02 | micro_F1 : 0.30/0.27:   1%|‚ñè         | 4/300 [00:31<31:07,  6.31s/it]train/val metrics at epoch 5 | loss : 1.09/1.02 | micro_F1 : 0.30/0.27:   2%|‚ñè         | 5/300 [00:31<31:26,  6.39s/it]train/val metrics at epoch 6 | loss : 1.07/1.01 | micro_F1 : 0.31/0.30:   2%|‚ñè         | 5/300 [00:38<31:26,  6.39s/it]train/val metrics at epoch 6 | loss : 1.07/1.01 | micro_F1 : 0.31/0.30:   2%|‚ñè         | 6/300 [00:38<31:24,  6.41s/it]train/val metrics at epoch 7 | loss : 1.06/0.99 | micro_F1 : 0.32/0.30:   2%|‚ñè         | 6/300 [00:44<31:24,  6.41s/it]train/val metrics at epoch 7 | loss : 1.06/0.99 | micro_F1 : 0.32/0.30:   2%|‚ñè         | 7/300 [00:44<31:05,  6.37s/it]train/val metrics at epoch 8 | loss : 1.04/0.99 | micro_F1 : 0.33/0.32:   2%|‚ñè         | 7/300 [00:50<31:05,  6.37s/it]train/val metrics at epoch 8 | loss : 1.04/0.99 | micro_F1 : 0.33/0.32:   3%|‚ñé         | 8/300 [00:50<30:47,  6.33s/it]train/val metrics at epoch 9 | loss : 1.02/0.96 | micro_F1 : 0.34/0.31:   3%|‚ñé         | 8/300 [00:57<30:47,  6.33s/it]train/val metrics at epoch 9 | loss : 1.02/0.96 | micro_F1 : 0.34/0.31:   3%|‚ñé         | 9/300 [00:57<30:40,  6.32s/it]train/val metrics at epoch 10 | loss : 1.01/0.96 | micro_F1 : 0.35/0.31:   3%|‚ñé         | 9/300 [01:03<30:40,  6.32s/it]train/val metrics at epoch 10 | loss : 1.01/0.96 | micro_F1 : 0.35/0.31:   3%|‚ñé         | 10/300 [01:03<30:33,  6.32s/it]train/val metrics at epoch 11 | loss : 1.00/0.95 | micro_F1 : 0.35/0.32:   3%|‚ñé         | 10/300 [01:09<30:33,  6.32s/it]train/val metrics at epoch 11 | loss : 1.00/0.95 | micro_F1 : 0.35/0.32:   4%|‚ñé         | 11/300 [01:09<30:26,  6.32s/it]train/val metrics at epoch 12 | loss : 0.99/0.95 | micro_F1 : 0.36/0.32:   4%|‚ñé         | 11/300 [01:15<30:26,  6.32s/it]train/val metrics at epoch 12 | loss : 0.99/0.95 | micro_F1 : 0.36/0.32:   4%|‚ñç         | 12/300 [01:16<30:14,  6.30s/it]train/val metrics at epoch 13 | loss : 0.98/0.94 | micro_F1 : 0.36/0.32:   4%|‚ñç         | 12/300 [01:22<30:14,  6.30s/it]train/val metrics at epoch 13 | loss : 0.98/0.94 | micro_F1 : 0.36/0.32:   4%|‚ñç         | 13/300 [01:22<30:23,  6.35s/it]train/val metrics at epoch 14 | loss : 0.96/0.94 | micro_F1 : 0.36/0.31:   4%|‚ñç         | 13/300 [01:28<30:23,  6.35s/it]train/val metrics at epoch 14 | loss : 0.96/0.94 | micro_F1 : 0.36/0.31:   5%|‚ñç         | 14/300 [01:29<30:31,  6.40s/it]train/val metrics at epoch 15 | loss : 0.96/0.93 | micro_F1 : 0.37/0.32:   5%|‚ñç         | 14/300 [01:35<30:31,  6.40s/it]train/val metrics at epoch 15 | loss : 0.96/0.93 | micro_F1 : 0.37/0.32:   5%|‚ñå         | 15/300 [01:35<30:23,  6.40s/it]train/val metrics at epoch 16 | loss : 0.95/0.94 | micro_F1 : 0.37/0.32:   5%|‚ñå         | 15/300 [01:41<30:23,  6.40s/it]train/val metrics at epoch 16 | loss : 0.95/0.94 | micro_F1 : 0.37/0.32:   5%|‚ñå         | 16/300 [01:41<30:10,  6.38s/it]train/val metrics at epoch 17 | loss : 0.94/0.93 | micro_F1 : 0.37/0.33:   5%|‚ñå         | 16/300 [01:48<30:10,  6.38s/it]train/val metrics at epoch 17 | loss : 0.94/0.93 | micro_F1 : 0.37/0.33:   6%|‚ñå         | 17/300 [01:48<30:11,  6.40s/it]train/val metrics at epoch 18 | loss : 0.93/0.93 | micro_F1 : 0.37/0.33:   6%|‚ñå         | 17/300 [01:54<30:11,  6.40s/it]train/val metrics at epoch 18 | loss : 0.93/0.93 | micro_F1 : 0.37/0.33:   6%|‚ñå         | 18/300 [01:54<29:55,  6.37s/it]train/val metrics at epoch 19 | loss : 0.92/0.92 | micro_F1 : 0.37/0.33:   6%|‚ñå         | 18/300 [02:00<29:55,  6.37s/it]train/val metrics at epoch 19 | loss : 0.92/0.92 | micro_F1 : 0.37/0.33:   6%|‚ñã         | 19/300 [02:00<29:42,  6.34s/it]train/val metrics at epoch 20 | loss : 0.91/0.92 | micro_F1 : 0.38/0.34:   6%|‚ñã         | 19/300 [02:06<29:42,  6.34s/it]train/val metrics at epoch 20 | loss : 0.91/0.92 | micro_F1 : 0.38/0.34:   7%|‚ñã         | 20/300 [02:07<29:28,  6.32s/it]train/val metrics at epoch 21 | loss : 0.91/0.92 | micro_F1 : 0.38/0.35:   7%|‚ñã         | 20/300 [02:13<29:28,  6.32s/it]train/val metrics at epoch 21 | loss : 0.91/0.92 | micro_F1 : 0.38/0.35:   7%|‚ñã         | 21/300 [02:13<29:17,  6.30s/it]train/val metrics at epoch 22 | loss : 0.90/0.91 | micro_F1 : 0.38/0.35:   7%|‚ñã         | 21/300 [02:19<29:17,  6.30s/it]train/val metrics at epoch 22 | loss : 0.90/0.91 | micro_F1 : 0.38/0.35:   7%|‚ñã         | 22/300 [02:19<29:02,  6.27s/it]train/val metrics at epoch 23 | loss : 0.89/0.92 | micro_F1 : 0.39/0.34:   7%|‚ñã         | 22/300 [02:25<29:02,  6.27s/it]train/val metrics at epoch 23 | loss : 0.89/0.92 | micro_F1 : 0.39/0.34:   8%|‚ñä         | 23/300 [02:25<28:55,  6.26s/it]train/val metrics at epoch 24 | loss : 0.88/0.91 | micro_F1 : 0.39/0.34:   8%|‚ñä         | 23/300 [02:32<28:55,  6.26s/it]train/val metrics at epoch 24 | loss : 0.88/0.91 | micro_F1 : 0.39/0.34:   8%|‚ñä         | 24/300 [02:32<28:57,  6.30s/it]train/val metrics at epoch 25 | loss : 0.87/0.91 | micro_F1 : 0.40/0.33:   8%|‚ñä         | 24/300 [02:38<28:57,  6.30s/it]train/val metrics at epoch 25 | loss : 0.87/0.91 | micro_F1 : 0.40/0.33:   8%|‚ñä         | 25/300 [02:38<29:09,  6.36s/it]train/val metrics at epoch 26 | loss : 0.87/0.92 | micro_F1 : 0.39/0.34:   8%|‚ñä         | 25/300 [02:44<29:09,  6.36s/it]train/val metrics at epoch 26 | loss : 0.87/0.92 | micro_F1 : 0.39/0.34:   9%|‚ñä         | 26/300 [02:45<28:56,  6.34s/it]train/val metrics at epoch 27 | loss : 0.87/0.92 | micro_F1 : 0.40/0.34:   9%|‚ñä         | 26/300 [02:51<28:56,  6.34s/it]train/val metrics at epoch 27 | loss : 0.87/0.92 | micro_F1 : 0.40/0.34:   9%|‚ñâ         | 27/300 [02:51<28:44,  6.32s/it]train/val metrics at epoch 28 | loss : 0.87/0.92 | micro_F1 : 0.40/0.34:   9%|‚ñâ         | 27/300 [02:57<28:44,  6.32s/it]train/val metrics at epoch 28 | loss : 0.87/0.92 | micro_F1 : 0.40/0.34:   9%|‚ñâ         | 28/300 [02:57<28:53,  6.37s/it]train/val metrics at epoch 29 | loss : 0.87/0.92 | micro_F1 : 0.40/0.34:   9%|‚ñâ         | 28/300 [03:04<28:53,  6.37s/it]train/val metrics at epoch 29 | loss : 0.87/0.92 | micro_F1 : 0.40/0.34:  10%|‚ñâ         | 29/300 [03:04<28:50,  6.39s/it]train/val metrics at epoch 30 | loss : 0.86/0.92 | micro_F1 : 0.40/0.35:  10%|‚ñâ         | 29/300 [03:10<28:50,  6.39s/it]train/val metrics at epoch 30 | loss : 0.86/0.92 | micro_F1 : 0.40/0.35:  10%|‚ñà         | 30/300 [03:10<28:46,  6.39s/it]train/val metrics at epoch 31 | loss : 0.86/0.92 | micro_F1 : 0.40/0.34:  10%|‚ñà         | 30/300 [03:16<28:46,  6.39s/it]train/val metrics at epoch 31 | loss : 0.86/0.92 | micro_F1 : 0.40/0.34:  10%|‚ñà         | 31/300 [03:17<28:52,  6.44s/it]train/val metrics at epoch 32 | loss : 0.86/0.92 | micro_F1 : 0.40/0.34:  10%|‚ñà         | 31/300 [03:23<28:52,  6.44s/it]train/val metrics at epoch 32 | loss : 0.86/0.92 | micro_F1 : 0.40/0.34:  10%|‚ñà         | 31/300 [03:24<29:31,  6.59s/it]
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:          epoch ‚ñÅ
wandb:  learning rate ‚ñÅ
wandb:           time ‚ñÅ
wandb:     train loss ‚ñÅ
wandb: train macro F1 ‚ñÅ
wandb: train micro F1 ‚ñÅ
wandb:       val loss ‚ñÅ
wandb:   val macro F1 ‚ñÅ
wandb:   val micro F1 ‚ñÅ
wandb: 
wandb: Run summary:
wandb:          epoch 32
wandb:  learning rate 0.0
wandb:           time 205.66448
wandb:     train loss 0.85932
wandb: train macro F1 0.33357
wandb: train micro F1 0.39891
wandb:       val loss 0.92347
wandb:   val macro F1 0.23545
wandb:   val micro F1 0.3403
wandb: 
wandb: üöÄ View run proud-shape-16 at: https://wandb.ai/msc-nicola/train_fusion_tuning/runs/wbrje1lw
wandb: Synced 5 W&B file(s), 1 media file(s), 1 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230626_171247-wbrje1lw/logs
Exception in thread NetStatThr:
Traceback (most recent call last):
  File "/ssoft/spack/arvine/v1/opt/spack/linux-rhel7-skylake_avx512/gcc-8.4.0/python-3.7.7-drpdlwdbo3lmtkcbckq227ypnzno4ek3/lib/python3.7/threading.py", line 926, in _bootstrap_inner
    self.run()
  File "/ssoft/spack/arvine/v1/opt/spack/linux-rhel7-skylake_avx512/gcc-8.4.0/python-3.7.7-drpdlwdbo3lmtkcbckq227ypnzno4ek3/lib/python3.7/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/home/santacro/masters_thesis/fusion_tuning/eceo/lib/python3.7/site-packages/wandb/sdk/wandb_run.py", line 262, in check_network_status
    process=_process_network_status,
  File "/home/santacro/masters_thesis/fusion_tuning/eceo/lib/python3.7/site-packages/wandb/sdk/wandb_run.py", line 213, in _loop_check_status
    local_handle = request()
  File "/home/santacro/masters_thesis/fusion_tuning/eceo/lib/python3.7/site-packages/wandb/sdk/interface/interface.py", line 797, in deliver_network_status
    return self._deliver_network_status(status)
  File "/home/santacro/masters_thesis/fusion_tuning/eceo/lib/python3.7/site-packages/wandb/sdk/interface/interface_shared.py", line 601, in _deliver_network_status
    return self._deliver_record(record)
  File "/home/santacro/masters_thesis/fusion_tuning/eceo/lib/python3.7/site-packages/wandb/sdk/interface/interface_shared.py", line 560, in _deliver_record
    handle = mailbox._deliver_record(record, interface=self)
  File "/home/santacro/masters_thesis/fusion_tuning/eceo/lib/python3.7/site-packages/wandb/sdk/lib/mailbox.py", line 455, in _deliver_record
    interface._publish(record)
  File "/home/santacro/masters_thesis/fusion_tuning/eceo/lib/python3.7/site-packages/wandb/sdk/interface/interface_sock.py", line 51, in _publish
    self._sock_client.send_record_publish(record)
  File "/home/santacro/masters_thesis/fusion_tuning/eceo/lib/python3.7/site-packages/wandb/sdk/lib/sock_client.py", line 221, in send_record_publish
    self.send_server_request(server_req)
  File "/home/santacro/masters_thesis/fusion_tuning/eceo/lib/python3.7/site-packages/wandb/sdk/lib/sock_client.py", line 155, in send_server_request
    self._send_message(msg)
  File "/home/santacro/masters_thesis/fusion_tuning/eceo/lib/python3.7/site-packages/wandb/sdk/lib/sock_client.py", line 152, in _send_message
    self._sendall_with_error_handle(header + data)
  File "/home/santacro/masters_thesis/fusion_tuning/eceo/lib/python3.7/site-packages/wandb/sdk/lib/sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
BrokenPipeError: [Errno 32] Broken pipe

